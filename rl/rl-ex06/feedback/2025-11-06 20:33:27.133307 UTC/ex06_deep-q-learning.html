<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>ex06_deep-q-learning</title>
<style type="text/css">
/*!
 * Bootstrap v3.3.4 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 *//*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{margin:.67em 0;font-size:2em}mark{color:#000;background:#ff0}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{height:0;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;font:inherit;color:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type=checkbox],input[type=radio]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;-webkit-appearance:textfield}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{padding:.35em .625em .75em;margin:0 2px;border:1px solid silver}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */@media print{*,:after,:before{color:#000!important;text-shadow:none!important;background:0 0!important;-webkit-box-shadow:none!important;box-shadow:none!important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}a[href^="javascript:"]:after,a[href^="#"]:after{content:""}blockquote,pre{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}img,tr{page-break-inside:avoid}img{max-width:100%!important}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}select{background:#fff!important}.navbar{display:none}.btn>.caret,.dropup>.btn>.caret{border-top-color:#000!important}.label{border:1px solid #000}.table{border-collapse:collapse!important}.table td,.table th{background-color:#fff!important}.table-bordered td,.table-bordered th{border:1px solid #ddd!important}}@font-face{font-family:'Glyphicons Halflings';src:url(../fonts/glyphicons-halflings-regular.eot);src:url(../fonts/glyphicons-halflings-regular.eot?#iefix) format('embedded-opentype'),url(../fonts/glyphicons-halflings-regular.woff2) format('woff2'),url(../fonts/glyphicons-halflings-regular.woff) format('woff'),url(../fonts/glyphicons-halflings-regular.ttf) format('truetype'),url(../fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular) format('svg')}.glyphicon{position:relative;top:1px;display:inline-block;font-family:'Glyphicons Halflings';font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.glyphicon-asterisk:before{content:"\2a"}.glyphicon-plus:before{content:"\2b"}.glyphicon-eur:before,.glyphicon-euro:before{content:"\20ac"}.glyphicon-minus:before{content:"\2212"}.glyphicon-cloud:before{content:"\2601"}.glyphicon-envelope:before{content:"\2709"}.glyphicon-pencil:before{content:"\270f"}.glyphicon-glass:before{content:"\e001"}.glyphicon-music:before{content:"\e002"}.glyphicon-search:before{content:"\e003"}.glyphicon-heart:before{content:"\e005"}.glyphicon-star:before{content:"\e006"}.glyphicon-star-empty:before{content:"\e007"}.glyphicon-user:before{content:"\e008"}.glyphicon-film:before{content:"\e009"}.glyphicon-th-large:before{content:"\e010"}.glyphicon-th:before{content:"\e011"}.glyphicon-th-list:before{content:"\e012"}.glyphicon-ok:before{content:"\e013"}.glyphicon-remove:before{content:"\e014"}.glyphicon-zoom-in:before{content:"\e015"}.glyphicon-zoom-out:before{content:"\e016"}.glyphicon-off:before{content:"\e017"}.glyphicon-signal:before{content:"\e018"}.glyphicon-cog:before{content:"\e019"}.glyphicon-trash:before{content:"\e020"}.glyphicon-home:before{content:"\e021"}.glyphicon-file:before{content:"\e022"}.glyphicon-time:before{content:"\e023"}.glyphicon-road:before{content:"\e024"}.glyphicon-download-alt:before{content:"\e025"}.glyphicon-download:before{content:"\e026"}.glyphicon-upload:before{content:"\e027"}.glyphicon-inbox:before{content:"\e028"}.glyphicon-play-circle:before{content:"\e029"}.glyphicon-repeat:before{content:"\e030"}.glyphicon-refresh:before{content:"\e031"}.glyphicon-list-alt:before{content:"\e032"}.glyphicon-lock:before{content:"\e033"}.glyphicon-flag:before{content:"\e034"}.glyphicon-headphones:before{content:"\e035"}.glyphicon-volume-off:before{content:"\e036"}.glyphicon-volume-down:before{content:"\e037"}.glyphicon-volume-up:before{content:"\e038"}.glyphicon-qrcode:before{content:"\e039"}.glyphicon-barcode:before{content:"\e040"}.glyphicon-tag:before{content:"\e041"}.glyphicon-tags:before{content:"\e042"}.glyphicon-book:before{content:"\e043"}.glyphicon-bookmark:before{content:"\e044"}.glyphicon-print:before{content:"\e045"}.glyphicon-camera:before{content:"\e046"}.glyphicon-font:before{content:"\e047"}.glyphicon-bold:before{content:"\e048"}.glyphicon-italic:before{content:"\e049"}.glyphicon-text-height:before{content:"\e050"}.glyphicon-text-width:before{content:"\e051"}.glyphicon-align-left:before{content:"\e052"}.glyphicon-align-center:before{content:"\e053"}.glyphicon-align-right:before{content:"\e054"}.glyphicon-align-justify:before{content:"\e055"}.glyphicon-list:before{content:"\e056"}.glyphicon-indent-left:before{content:"\e057"}.glyphicon-indent-right:before{content:"\e058"}.glyphicon-facetime-video:before{content:"\e059"}.glyphicon-picture:before{content:"\e060"}.glyphicon-map-marker:before{content:"\e062"}.glyphicon-adjust:before{content:"\e063"}.glyphicon-tint:before{content:"\e064"}.glyphicon-edit:before{content:"\e065"}.glyphicon-share:before{content:"\e066"}.glyphicon-check:before{content:"\e067"}.glyphicon-move:before{content:"\e068"}.glyphicon-step-backward:before{content:"\e069"}.glyphicon-fast-backward:before{content:"\e070"}.glyphicon-backward:before{content:"\e071"}.glyphicon-play:before{content:"\e072"}.glyphicon-pause:before{content:"\e073"}.glyphicon-stop:before{content:"\e074"}.glyphicon-forward:before{content:"\e075"}.glyphicon-fast-forward:before{content:"\e076"}.glyphicon-step-forward:before{content:"\e077"}.glyphicon-eject:before{content:"\e078"}.glyphicon-chevron-left:before{content:"\e079"}.glyphicon-chevron-right:before{content:"\e080"}.glyphicon-plus-sign:before{content:"\e081"}.glyphicon-minus-sign:before{content:"\e082"}.glyphicon-remove-sign:before{content:"\e083"}.glyphicon-ok-sign:before{content:"\e084"}.glyphicon-question-sign:before{content:"\e085"}.glyphicon-info-sign:before{content:"\e086"}.glyphicon-screenshot:before{content:"\e087"}.glyphicon-remove-circle:before{content:"\e088"}.glyphicon-ok-circle:before{content:"\e089"}.glyphicon-ban-circle:before{content:"\e090"}.glyphicon-arrow-left:before{content:"\e091"}.glyphicon-arrow-right:before{content:"\e092"}.glyphicon-arrow-up:before{content:"\e093"}.glyphicon-arrow-down:before{content:"\e094"}.glyphicon-share-alt:before{content:"\e095"}.glyphicon-resize-full:before{content:"\e096"}.glyphicon-resize-small:before{content:"\e097"}.glyphicon-exclamation-sign:before{content:"\e101"}.glyphicon-gift:before{content:"\e102"}.glyphicon-leaf:before{content:"\e103"}.glyphicon-fire:before{content:"\e104"}.glyphicon-eye-open:before{content:"\e105"}.glyphicon-eye-close:before{content:"\e106"}.glyphicon-warning-sign:before{content:"\e107"}.glyphicon-plane:before{content:"\e108"}.glyphicon-calendar:before{content:"\e109"}.glyphicon-random:before{content:"\e110"}.glyphicon-comment:before{content:"\e111"}.glyphicon-magnet:before{content:"\e112"}.glyphicon-chevron-up:before{content:"\e113"}.glyphicon-chevron-down:before{content:"\e114"}.glyphicon-retweet:before{content:"\e115"}.glyphicon-shopping-cart:before{content:"\e116"}.glyphicon-folder-close:before{content:"\e117"}.glyphicon-folder-open:before{content:"\e118"}.glyphicon-resize-vertical:before{content:"\e119"}.glyphicon-resize-horizontal:before{content:"\e120"}.glyphicon-hdd:before{content:"\e121"}.glyphicon-bullhorn:before{content:"\e122"}.glyphicon-bell:before{content:"\e123"}.glyphicon-certificate:before{content:"\e124"}.glyphicon-thumbs-up:before{content:"\e125"}.glyphicon-thumbs-down:before{content:"\e126"}.glyphicon-hand-right:before{content:"\e127"}.glyphicon-hand-left:before{content:"\e128"}.glyphicon-hand-up:before{content:"\e129"}.glyphicon-hand-down:before{content:"\e130"}.glyphicon-circle-arrow-right:before{content:"\e131"}.glyphicon-circle-arrow-left:before{content:"\e132"}.glyphicon-circle-arrow-up:before{content:"\e133"}.glyphicon-circle-arrow-down:before{content:"\e134"}.glyphicon-globe:before{content:"\e135"}.glyphicon-wrench:before{content:"\e136"}.glyphicon-tasks:before{content:"\e137"}.glyphicon-filter:before{content:"\e138"}.glyphicon-briefcase:before{content:"\e139"}.glyphicon-fullscreen:before{content:"\e140"}.glyphicon-dashboard:before{content:"\e141"}.glyphicon-paperclip:before{content:"\e142"}.glyphicon-heart-empty:before{content:"\e143"}.glyphicon-link:before{content:"\e144"}.glyphicon-phone:before{content:"\e145"}.glyphicon-pushpin:before{content:"\e146"}.glyphicon-usd:before{content:"\e148"}.glyphicon-gbp:before{content:"\e149"}.glyphicon-sort:before{content:"\e150"}.glyphicon-sort-by-alphabet:before{content:"\e151"}.glyphicon-sort-by-alphabet-alt:before{content:"\e152"}.glyphicon-sort-by-order:before{content:"\e153"}.glyphicon-sort-by-order-alt:before{content:"\e154"}.glyphicon-sort-by-attributes:before{content:"\e155"}.glyphicon-sort-by-attributes-alt:before{content:"\e156"}.glyphicon-unchecked:before{content:"\e157"}.glyphicon-expand:before{content:"\e158"}.glyphicon-collapse-down:before{content:"\e159"}.glyphicon-collapse-up:before{content:"\e160"}.glyphicon-log-in:before{content:"\e161"}.glyphicon-flash:before{content:"\e162"}.glyphicon-log-out:before{content:"\e163"}.glyphicon-new-window:before{content:"\e164"}.glyphicon-record:before{content:"\e165"}.glyphicon-save:before{content:"\e166"}.glyphicon-open:before{content:"\e167"}.glyphicon-saved:before{content:"\e168"}.glyphicon-import:before{content:"\e169"}.glyphicon-export:before{content:"\e170"}.glyphicon-send:before{content:"\e171"}.glyphicon-floppy-disk:before{content:"\e172"}.glyphicon-floppy-saved:before{content:"\e173"}.glyphicon-floppy-remove:before{content:"\e174"}.glyphicon-floppy-save:before{content:"\e175"}.glyphicon-floppy-open:before{content:"\e176"}.glyphicon-credit-card:before{content:"\e177"}.glyphicon-transfer:before{content:"\e178"}.glyphicon-cutlery:before{content:"\e179"}.glyphicon-header:before{content:"\e180"}.glyphicon-compressed:before{content:"\e181"}.glyphicon-earphone:before{content:"\e182"}.glyphicon-phone-alt:before{content:"\e183"}.glyphicon-tower:before{content:"\e184"}.glyphicon-stats:before{content:"\e185"}.glyphicon-sd-video:before{content:"\e186"}.glyphicon-hd-video:before{content:"\e187"}.glyphicon-subtitles:before{content:"\e188"}.glyphicon-sound-stereo:before{content:"\e189"}.glyphicon-sound-dolby:before{content:"\e190"}.glyphicon-sound-5-1:before{content:"\e191"}.glyphicon-sound-6-1:before{content:"\e192"}.glyphicon-sound-7-1:before{content:"\e193"}.glyphicon-copyright-mark:before{content:"\e194"}.glyphicon-registration-mark:before{content:"\e195"}.glyphicon-cloud-download:before{content:"\e197"}.glyphicon-cloud-upload:before{content:"\e198"}.glyphicon-tree-conifer:before{content:"\e199"}.glyphicon-tree-deciduous:before{content:"\e200"}.glyphicon-cd:before{content:"\e201"}.glyphicon-save-file:before{content:"\e202"}.glyphicon-open-file:before{content:"\e203"}.glyphicon-level-up:before{content:"\e204"}.glyphicon-copy:before{content:"\e205"}.glyphicon-paste:before{content:"\e206"}.glyphicon-alert:before{content:"\e209"}.glyphicon-equalizer:before{content:"\e210"}.glyphicon-king:before{content:"\e211"}.glyphicon-queen:before{content:"\e212"}.glyphicon-pawn:before{content:"\e213"}.glyphicon-bishop:before{content:"\e214"}.glyphicon-knight:before{content:"\e215"}.glyphicon-baby-formula:before{content:"\e216"}.glyphicon-tent:before{content:"\26fa"}.glyphicon-blackboard:before{content:"\e218"}.glyphicon-bed:before{content:"\e219"}.glyphicon-apple:before{content:"\f8ff"}.glyphicon-erase:before{content:"\e221"}.glyphicon-hourglass:before{content:"\231b"}.glyphicon-lamp:before{content:"\e223"}.glyphicon-duplicate:before{content:"\e224"}.glyphicon-piggy-bank:before{content:"\e225"}.glyphicon-scissors:before{content:"\e226"}.glyphicon-bitcoin:before{content:"\e227"}.glyphicon-btc:before{content:"\e227"}.glyphicon-xbt:before{content:"\e227"}.glyphicon-yen:before{content:"\00a5"}.glyphicon-jpy:before{content:"\00a5"}.glyphicon-ruble:before{content:"\20bd"}.glyphicon-rub:before{content:"\20bd"}.glyphicon-scale:before{content:"\e230"}.glyphicon-ice-lolly:before{content:"\e231"}.glyphicon-ice-lolly-tasted:before{content:"\e232"}.glyphicon-education:before{content:"\e233"}.glyphicon-option-horizontal:before{content:"\e234"}.glyphicon-option-vertical:before{content:"\e235"}.glyphicon-menu-hamburger:before{content:"\e236"}.glyphicon-modal-window:before{content:"\e237"}.glyphicon-oil:before{content:"\e238"}.glyphicon-grain:before{content:"\e239"}.glyphicon-sunglasses:before{content:"\e240"}.glyphicon-text-size:before{content:"\e241"}.glyphicon-text-color:before{content:"\e242"}.glyphicon-text-background:before{content:"\e243"}.glyphicon-object-align-top:before{content:"\e244"}.glyphicon-object-align-bottom:before{content:"\e245"}.glyphicon-object-align-horizontal:before{content:"\e246"}.glyphicon-object-align-left:before{content:"\e247"}.glyphicon-object-align-vertical:before{content:"\e248"}.glyphicon-object-align-right:before{content:"\e249"}.glyphicon-triangle-right:before{content:"\e250"}.glyphicon-triangle-left:before{content:"\e251"}.glyphicon-triangle-bottom:before{content:"\e252"}.glyphicon-triangle-top:before{content:"\e253"}.glyphicon-console:before{content:"\e254"}.glyphicon-superscript:before{content:"\e255"}.glyphicon-subscript:before{content:"\e256"}.glyphicon-menu-left:before{content:"\e257"}.glyphicon-menu-right:before{content:"\e258"}.glyphicon-menu-down:before{content:"\e259"}.glyphicon-menu-up:before{content:"\e260"}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html{font-size:10px;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff}button,input,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}a{color:#337ab7;text-decoration:none}a:focus,a:hover{color:#23527c;text-decoration:underline}a:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}figure{margin:0}img{vertical-align:middle}.carousel-inner>.item>a>img,.carousel-inner>.item>img,.img-responsive,.thumbnail a>img,.thumbnail>img{display:block;max-width:100%;height:auto}.img-rounded{border-radius:6px}.img-thumbnail{display:inline-block;max-width:100%;height:auto;padding:4px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.img-circle{border-radius:50%}hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}[role=button]{cursor:pointer}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{font-family:inherit;font-weight:500;line-height:1.1;color:inherit}.h1 .small,.h1 small,.h2 .small,.h2 small,.h3 .small,.h3 small,.h4 .small,.h4 small,.h5 .small,.h5 small,.h6 .small,.h6 small,h1 .small,h1 small,h2 .small,h2 small,h3 .small,h3 small,h4 .small,h4 small,h5 .small,h5 small,h6 .small,h6 small{font-weight:400;line-height:1;color:#777}.h1,.h2,.h3,h1,h2,h3{margin-top:20px;margin-bottom:10px}.h1 .small,.h1 small,.h2 .small,.h2 small,.h3 .small,.h3 small,h1 .small,h1 small,h2 .small,h2 small,h3 .small,h3 small{font-size:65%}.h4,.h5,.h6,h4,h5,h6{margin-top:10px;margin-bottom:10px}.h4 .small,.h4 small,.h5 .small,.h5 small,.h6 .small,.h6 small,h4 .small,h4 small,h5 .small,h5 small,h6 .small,h6 small{font-size:75%}.h1,h1{font-size:36px}.h2,h2{font-size:30px}.h3,h3{font-size:24px}.h4,h4{font-size:18px}.h5,h5{font-size:14px}.h6,h6{font-size:12px}p{margin:0 0 10px}.lead{margin-bottom:20px;font-size:16px;font-weight:300;line-height:1.4}@media (min-width:768px){.lead{font-size:21px}}.small,small{font-size:85%}.mark,mark{padding:.2em;background-color:#fcf8e3}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}.text-nowrap{white-space:nowrap}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.text-muted{color:#777}.text-primary{color:#337ab7}a.text-primary:hover{color:#286090}.text-success{color:#3c763d}a.text-success:hover{color:#2b542c}.text-info{color:#31708f}a.text-info:hover{color:#245269}.text-warning{color:#8a6d3b}a.text-warning:hover{color:#66512c}.text-danger{color:#a94442}a.text-danger:hover{color:#843534}.bg-primary{color:#fff;background-color:#337ab7}a.bg-primary:hover{background-color:#286090}.bg-success{background-color:#dff0d8}a.bg-success:hover{background-color:#c1e2b3}.bg-info{background-color:#d9edf7}a.bg-info:hover{background-color:#afd9ee}.bg-warning{background-color:#fcf8e3}a.bg-warning:hover{background-color:#f7ecb5}.bg-danger{background-color:#f2dede}a.bg-danger:hover{background-color:#e4b9b9}.page-header{padding-bottom:9px;margin:40px 0 20px;border-bottom:1px solid #eee}ol,ul{margin-top:0;margin-bottom:10px}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}.list-unstyled{padding-left:0;list-style:none}.list-inline{padding-left:0;margin-left:-5px;list-style:none}.list-inline>li{display:inline-block;padding-right:5px;padding-left:5px}dl{margin-top:0;margin-bottom:20px}dd,dt{line-height:1.42857143}dt{font-weight:700}dd{margin-left:0}@media (min-width:768px){.dl-horizontal dt{float:left;width:160px;overflow:hidden;clear:left;text-align:right;text-overflow:ellipsis;white-space:nowrap}.dl-horizontal dd{margin-left:180px}}abbr[data-original-title],abbr[title]{cursor:help;border-bottom:1px dotted #777}.initialism{font-size:90%;text-transform:uppercase}blockquote{padding:10px 20px;margin:0 0 20px;font-size:17.5px;border-left:5px solid #eee}blockquote ol:last-child,blockquote p:last-child,blockquote ul:last-child{margin-bottom:0}blockquote .small,blockquote footer,blockquote small{display:block;font-size:80%;line-height:1.42857143;color:#777}blockquote .small:before,blockquote footer:before,blockquote small:before{content:'\2014 \00A0'}.blockquote-reverse,blockquote.pull-right{padding-right:15px;padding-left:0;text-align:right;border-right:5px solid #eee;border-left:0}.blockquote-reverse .small:before,.blockquote-reverse footer:before,.blockquote-reverse small:before,blockquote.pull-right .small:before,blockquote.pull-right footer:before,blockquote.pull-right small:before{content:''}.blockquote-reverse .small:after,.blockquote-reverse footer:after,.blockquote-reverse small:after,blockquote.pull-right .small:after,blockquote.pull-right footer:after,blockquote.pull-right small:after{content:'\00A0 \2014'}address{margin-bottom:20px;font-style:normal;line-height:1.42857143}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,"Courier New",monospace}code{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:4px}kbd{padding:2px 4px;font-size:90%;color:#fff;background-color:#333;border-radius:3px;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.25);box-shadow:inset 0 -1px 0 rgba(0,0,0,.25)}kbd kbd{padding:0;font-size:100%;font-weight:700;-webkit-box-shadow:none;box-shadow:none}pre{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;color:#333;word-break:break-all;word-wrap:break-word;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px}pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0}.pre-scrollable{max-height:340px;overflow-y:scroll}.container{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:768px){.container{width:750px}}@media (min-width:992px){.container{width:970px}}@media (min-width:1200px){.container{width:1170px}}.container-fluid{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}.row{margin-right:-15px;margin-left:-15px}.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9{position:relative;min-height:1px;padding-right:15px;padding-left:15px}.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9{float:left}.col-xs-12{width:100%}.col-xs-11{width:91.66666667%}.col-xs-10{width:83.33333333%}.col-xs-9{width:75%}.col-xs-8{width:66.66666667%}.col-xs-7{width:58.33333333%}.col-xs-6{width:50%}.col-xs-5{width:41.66666667%}.col-xs-4{width:33.33333333%}.col-xs-3{width:25%}.col-xs-2{width:16.66666667%}.col-xs-1{width:8.33333333%}.col-xs-pull-12{right:100%}.col-xs-pull-11{right:91.66666667%}.col-xs-pull-10{right:83.33333333%}.col-xs-pull-9{right:75%}.col-xs-pull-8{right:66.66666667%}.col-xs-pull-7{right:58.33333333%}.col-xs-pull-6{right:50%}.col-xs-pull-5{right:41.66666667%}.col-xs-pull-4{right:33.33333333%}.col-xs-pull-3{right:25%}.col-xs-pull-2{right:16.66666667%}.col-xs-pull-1{right:8.33333333%}.col-xs-pull-0{right:auto}.col-xs-push-12{left:100%}.col-xs-push-11{left:91.66666667%}.col-xs-push-10{left:83.33333333%}.col-xs-push-9{left:75%}.col-xs-push-8{left:66.66666667%}.col-xs-push-7{left:58.33333333%}.col-xs-push-6{left:50%}.col-xs-push-5{left:41.66666667%}.col-xs-push-4{left:33.33333333%}.col-xs-push-3{left:25%}.col-xs-push-2{left:16.66666667%}.col-xs-push-1{left:8.33333333%}.col-xs-push-0{left:auto}.col-xs-offset-12{margin-left:100%}.col-xs-offset-11{margin-left:91.66666667%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-0{margin-left:0}@media (min-width:768px){.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media (min-width:992px){.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}@media (min-width:1200px){.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9{float:left}.col-lg-12{width:100%}.col-lg-11{width:91.66666667%}.col-lg-10{width:83.33333333%}.col-lg-9{width:75%}.col-lg-8{width:66.66666667%}.col-lg-7{width:58.33333333%}.col-lg-6{width:50%}.col-lg-5{width:41.66666667%}.col-lg-4{width:33.33333333%}.col-lg-3{width:25%}.col-lg-2{width:16.66666667%}.col-lg-1{width:8.33333333%}.col-lg-pull-12{right:100%}.col-lg-pull-11{right:91.66666667%}.col-lg-pull-10{right:83.33333333%}.col-lg-pull-9{right:75%}.col-lg-pull-8{right:66.66666667%}.col-lg-pull-7{right:58.33333333%}.col-lg-pull-6{right:50%}.col-lg-pull-5{right:41.66666667%}.col-lg-pull-4{right:33.33333333%}.col-lg-pull-3{right:25%}.col-lg-pull-2{right:16.66666667%}.col-lg-pull-1{right:8.33333333%}.col-lg-pull-0{right:auto}.col-lg-push-12{left:100%}.col-lg-push-11{left:91.66666667%}.col-lg-push-10{left:83.33333333%}.col-lg-push-9{left:75%}.col-lg-push-8{left:66.66666667%}.col-lg-push-7{left:58.33333333%}.col-lg-push-6{left:50%}.col-lg-push-5{left:41.66666667%}.col-lg-push-4{left:33.33333333%}.col-lg-push-3{left:25%}.col-lg-push-2{left:16.66666667%}.col-lg-push-1{left:8.33333333%}.col-lg-push-0{left:auto}.col-lg-offset-12{margin-left:100%}.col-lg-offset-11{margin-left:91.66666667%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-0{margin-left:0}}table{background-color:transparent}caption{padding-top:8px;padding-bottom:8px;color:#777;text-align:left}th{text-align:left}.table{width:100%;max-width:100%;margin-bottom:20px}.table>tbody>tr>td,.table>tbody>tr>th,.table>tfoot>tr>td,.table>tfoot>tr>th,.table>thead>tr>td,.table>thead>tr>th{padding:8px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}.table>thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table>caption+thead>tr:first-child>td,.table>caption+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>th,.table>thead:first-child>tr:first-child>td,.table>thead:first-child>tr:first-child>th{border-top:0}.table>tbody+tbody{border-top:2px solid #ddd}.table .table{background-color:#fff}.table-condensed>tbody>tr>td,.table-condensed>tbody>tr>th,.table-condensed>tfoot>tr>td,.table-condensed>tfoot>tr>th,.table-condensed>thead>tr>td,.table-condensed>thead>tr>th{padding:5px}.table-bordered{border:1px solid #ddd}.table-bordered>tbody>tr>td,.table-bordered>tbody>tr>th,.table-bordered>tfoot>tr>td,.table-bordered>tfoot>tr>th,.table-bordered>thead>tr>td,.table-bordered>thead>tr>th{border:1px solid #ddd}.table-bordered>thead>tr>td,.table-bordered>thead>tr>th{border-bottom-width:2px}.table-striped>tbody>tr:nth-of-type(odd){background-color:#f9f9f9}.table-hover>tbody>tr:hover{background-color:#f5f5f5}table col[class*=col-]{position:static;display:table-column;float:none}table td[class*=col-],table th[class*=col-]{position:static;display:table-cell;float:none}.table>tbody>tr.active>td,.table>tbody>tr.active>th,.table>tbody>tr>td.active,.table>tbody>tr>th.active,.table>tfoot>tr.active>td,.table>tfoot>tr.active>th,.table>tfoot>tr>td.active,.table>tfoot>tr>th.active,.table>thead>tr.active>td,.table>thead>tr.active>th,.table>thead>tr>td.active,.table>thead>tr>th.active{background-color:#f5f5f5}.table-hover>tbody>tr.active:hover>td,.table-hover>tbody>tr.active:hover>th,.table-hover>tbody>tr:hover>.active,.table-hover>tbody>tr>td.active:hover,.table-hover>tbody>tr>th.active:hover{background-color:#e8e8e8}.table>tbody>tr.success>td,.table>tbody>tr.success>th,.table>tbody>tr>td.success,.table>tbody>tr>th.success,.table>tfoot>tr.success>td,.table>tfoot>tr.success>th,.table>tfoot>tr>td.success,.table>tfoot>tr>th.success,.table>thead>tr.success>td,.table>thead>tr.success>th,.table>thead>tr>td.success,.table>thead>tr>th.success{background-color:#dff0d8}.table-hover>tbody>tr.success:hover>td,.table-hover>tbody>tr.success:hover>th,.table-hover>tbody>tr:hover>.success,.table-hover>tbody>tr>td.success:hover,.table-hover>tbody>tr>th.success:hover{background-color:#d0e9c6}.table>tbody>tr.info>td,.table>tbody>tr.info>th,.table>tbody>tr>td.info,.table>tbody>tr>th.info,.table>tfoot>tr.info>td,.table>tfoot>tr.info>th,.table>tfoot>tr>td.info,.table>tfoot>tr>th.info,.table>thead>tr.info>td,.table>thead>tr.info>th,.table>thead>tr>td.info,.table>thead>tr>th.info{background-color:#d9edf7}.table-hover>tbody>tr.info:hover>td,.table-hover>tbody>tr.info:hover>th,.table-hover>tbody>tr:hover>.info,.table-hover>tbody>tr>td.info:hover,.table-hover>tbody>tr>th.info:hover{background-color:#c4e3f3}.table>tbody>tr.warning>td,.table>tbody>tr.warning>th,.table>tbody>tr>td.warning,.table>tbody>tr>th.warning,.table>tfoot>tr.warning>td,.table>tfoot>tr.warning>th,.table>tfoot>tr>td.warning,.table>tfoot>tr>th.warning,.table>thead>tr.warning>td,.table>thead>tr.warning>th,.table>thead>tr>td.warning,.table>thead>tr>th.warning{background-color:#fcf8e3}.table-hover>tbody>tr.warning:hover>td,.table-hover>tbody>tr.warning:hover>th,.table-hover>tbody>tr:hover>.warning,.table-hover>tbody>tr>td.warning:hover,.table-hover>tbody>tr>th.warning:hover{background-color:#faf2cc}.table>tbody>tr.danger>td,.table>tbody>tr.danger>th,.table>tbody>tr>td.danger,.table>tbody>tr>th.danger,.table>tfoot>tr.danger>td,.table>tfoot>tr.danger>th,.table>tfoot>tr>td.danger,.table>tfoot>tr>th.danger,.table>thead>tr.danger>td,.table>thead>tr.danger>th,.table>thead>tr>td.danger,.table>thead>tr>th.danger{background-color:#f2dede}.table-hover>tbody>tr.danger:hover>td,.table-hover>tbody>tr.danger:hover>th,.table-hover>tbody>tr:hover>.danger,.table-hover>tbody>tr>td.danger:hover,.table-hover>tbody>tr>th.danger:hover{background-color:#ebcccc}.table-responsive{min-height:.01%;overflow-x:auto}@media screen and (max-width:767px){.table-responsive{width:100%;margin-bottom:15px;overflow-y:hidden;-ms-overflow-style:-ms-autohiding-scrollbar;border:1px solid #ddd}.table-responsive>.table{margin-bottom:0}.table-responsive>.table>tbody>tr>td,.table-responsive>.table>tbody>tr>th,.table-responsive>.table>tfoot>tr>td,.table-responsive>.table>tfoot>tr>th,.table-responsive>.table>thead>tr>td,.table-responsive>.table>thead>tr>th{white-space:nowrap}.table-responsive>.table-bordered{border:0}.table-responsive>.table-bordered>tbody>tr>td:first-child,.table-responsive>.table-bordered>tbody>tr>th:first-child,.table-responsive>.table-bordered>tfoot>tr>td:first-child,.table-responsive>.table-bordered>tfoot>tr>th:first-child,.table-responsive>.table-bordered>thead>tr>td:first-child,.table-responsive>.table-bordered>thead>tr>th:first-child{border-left:0}.table-responsive>.table-bordered>tbody>tr>td:last-child,.table-responsive>.table-bordered>tbody>tr>th:last-child,.table-responsive>.table-bordered>tfoot>tr>td:last-child,.table-responsive>.table-bordered>tfoot>tr>th:last-child,.table-responsive>.table-bordered>thead>tr>td:last-child,.table-responsive>.table-bordered>thead>tr>th:last-child{border-right:0}.table-responsive>.table-bordered>tbody>tr:last-child>td,.table-responsive>.table-bordered>tbody>tr:last-child>th,.table-responsive>.table-bordered>tfoot>tr:last-child>td,.table-responsive>.table-bordered>tfoot>tr:last-child>th{border-bottom:0}}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;padding:0;margin-bottom:20px;font-size:21px;line-height:inherit;color:#333;border:0;border-bottom:1px solid #e5e5e5}label{display:inline-block;max-width:100%;margin-bottom:5px;font-weight:700}input[type=search]{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}input[type=checkbox],input[type=radio]{margin:4px 0 0;margin-top:1px \9;line-height:normal}input[type=file]{display:block}input[type=range]{display:block;width:100%}select[multiple],select[size]{height:auto}input[type=file]:focus,input[type=checkbox]:focus,input[type=radio]:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}output{display:block;padding-top:7px;font-size:14px;line-height:1.42857143;color:#555}.form-control{display:block;width:100%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}.form-control::-moz-placeholder{color:#999;opacity:1}.form-control:-ms-input-placeholder{color:#999}.form-control::-webkit-input-placeholder{color:#999}.form-control[disabled],.form-control[readonly],fieldset[disabled] .form-control{background-color:#eee;opacity:1}.form-control[disabled],fieldset[disabled] .form-control{cursor:not-allowed}textarea.form-control{height:auto}input[type=search]{-webkit-appearance:none}@media screen and (-webkit-min-device-pixel-ratio:0){input[type=date],input[type=time],input[type=datetime-local],input[type=month]{line-height:34px}.input-group-sm input[type=date],.input-group-sm input[type=time],.input-group-sm input[type=datetime-local],.input-group-sm input[type=month],input[type=date].input-sm,input[type=time].input-sm,input[type=datetime-local].input-sm,input[type=month].input-sm{line-height:30px}.input-group-lg input[type=date],.input-group-lg input[type=time],.input-group-lg input[type=datetime-local],.input-group-lg input[type=month],input[type=date].input-lg,input[type=time].input-lg,input[type=datetime-local].input-lg,input[type=month].input-lg{line-height:46px}}.form-group{margin-bottom:15px}.checkbox,.radio{position:relative;display:block;margin-top:10px;margin-bottom:10px}.checkbox label,.radio label{min-height:20px;padding-left:20px;margin-bottom:0;font-weight:400;cursor:pointer}.checkbox input[type=checkbox],.checkbox-inline input[type=checkbox],.radio input[type=radio],.radio-inline input[type=radio]{position:absolute;margin-top:4px \9;margin-left:-20px}.checkbox+.checkbox,.radio+.radio{margin-top:-5px}.checkbox-inline,.radio-inline{position:relative;display:inline-block;padding-left:20px;margin-bottom:0;font-weight:400;vertical-align:middle;cursor:pointer}.checkbox-inline+.checkbox-inline,.radio-inline+.radio-inline{margin-top:0;margin-left:10px}fieldset[disabled] input[type=checkbox],fieldset[disabled] input[type=radio],input[type=checkbox].disabled,input[type=checkbox][disabled],input[type=radio].disabled,input[type=radio][disabled]{cursor:not-allowed}.checkbox-inline.disabled,.radio-inline.disabled,fieldset[disabled] .checkbox-inline,fieldset[disabled] .radio-inline{cursor:not-allowed}.checkbox.disabled label,.radio.disabled label,fieldset[disabled] .checkbox label,fieldset[disabled] .radio label{cursor:not-allowed}.form-control-static{min-height:34px;padding-top:7px;padding-bottom:7px;margin-bottom:0}.form-control-static.input-lg,.form-control-static.input-sm{padding-right:0;padding-left:0}.input-sm{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-sm{height:30px;line-height:30px}select[multiple].input-sm,textarea.input-sm{height:auto}.form-group-sm .form-control{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.form-group-sm .form-control{height:30px;line-height:30px}select[multiple].form-group-sm .form-control,textarea.form-group-sm .form-control{height:auto}.form-group-sm .form-control-static{height:30px;min-height:32px;padding:5px 10px;font-size:12px;line-height:1.5}.input-lg{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}select.input-lg{height:46px;line-height:46px}select[multiple].input-lg,textarea.input-lg{height:auto}.form-group-lg .form-control{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}select.form-group-lg .form-control{height:46px;line-height:46px}select[multiple].form-group-lg .form-control,textarea.form-group-lg .form-control{height:auto}.form-group-lg .form-control-static{height:46px;min-height:38px;padding:10px 16px;font-size:18px;line-height:1.3333333}.has-feedback{position:relative}.has-feedback .form-control{padding-right:42.5px}.form-control-feedback{position:absolute;top:0;right:0;z-index:2;display:block;width:34px;height:34px;line-height:34px;text-align:center;pointer-events:none}.input-lg+.form-control-feedback{width:46px;height:46px;line-height:46px}.input-sm+.form-control-feedback{width:30px;height:30px;line-height:30px}.has-success .checkbox,.has-success .checkbox-inline,.has-success .control-label,.has-success .help-block,.has-success .radio,.has-success .radio-inline,.has-success.checkbox label,.has-success.checkbox-inline label,.has-success.radio label,.has-success.radio-inline label{color:#3c763d}.has-success .form-control{border-color:#3c763d;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-success .form-control:focus{border-color:#2b542c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #67b168;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #67b168}.has-success .input-group-addon{color:#3c763d;background-color:#dff0d8;border-color:#3c763d}.has-success .form-control-feedback{color:#3c763d}.has-warning .checkbox,.has-warning .checkbox-inline,.has-warning .control-label,.has-warning .help-block,.has-warning .radio,.has-warning .radio-inline,.has-warning.checkbox label,.has-warning.checkbox-inline label,.has-warning.radio label,.has-warning.radio-inline label{color:#8a6d3b}.has-warning .form-control{border-color:#8a6d3b;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-warning .form-control:focus{border-color:#66512c;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #c0a16b;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #c0a16b}.has-warning .input-group-addon{color:#8a6d3b;background-color:#fcf8e3;border-color:#8a6d3b}.has-warning .form-control-feedback{color:#8a6d3b}.has-error .checkbox,.has-error .checkbox-inline,.has-error .control-label,.has-error .help-block,.has-error .radio,.has-error .radio-inline,.has-error.checkbox label,.has-error.checkbox-inline label,.has-error.radio label,.has-error.radio-inline label{color:#a94442}.has-error .form-control{border-color:#a94442;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-error .form-control:focus{border-color:#843534;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #ce8483;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #ce8483}.has-error .input-group-addon{color:#a94442;background-color:#f2dede;border-color:#a94442}.has-error .form-control-feedback{color:#a94442}.has-feedback label~.form-control-feedback{top:25px}.has-feedback label.sr-only~.form-control-feedback{top:0}.help-block{display:block;margin-top:5px;margin-bottom:10px;color:#737373}@media (min-width:768px){.form-inline .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .form-control-static{display:inline-block}.form-inline .input-group{display:inline-table;vertical-align:middle}.form-inline .input-group .form-control,.form-inline .input-group .input-group-addon,.form-inline .input-group .input-group-btn{width:auto}.form-inline .input-group>.form-control{width:100%}.form-inline .control-label{margin-bottom:0;vertical-align:middle}.form-inline .checkbox,.form-inline .radio{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.form-inline .checkbox label,.form-inline .radio label{padding-left:0}.form-inline .checkbox input[type=checkbox],.form-inline .radio input[type=radio]{position:relative;margin-left:0}.form-inline .has-feedback .form-control-feedback{top:0}}.form-horizontal .checkbox,.form-horizontal .checkbox-inline,.form-horizontal .radio,.form-horizontal .radio-inline{padding-top:7px;margin-top:0;margin-bottom:0}.form-horizontal .checkbox,.form-horizontal .radio{min-height:27px}.form-horizontal .form-group{margin-right:-15px;margin-left:-15px}@media (min-width:768px){.form-horizontal .control-label{padding-top:7px;margin-bottom:0;text-align:right}}.form-horizontal .has-feedback .form-control-feedback{right:15px}@media (min-width:768px){.form-horizontal .form-group-lg .control-label{padding-top:14.33px}}@media (min-width:768px){.form-horizontal .form-group-sm .control-label{padding-top:6px}}.btn{display:inline-block;padding:6px 12px;margin-bottom:0;font-size:14px;font-weight:400;line-height:1.42857143;text-align:center;white-space:nowrap;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-image:none;border:1px solid transparent;border-radius:4px}.btn.active.focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn:active:focus,.btn:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn.focus,.btn:focus,.btn:hover{color:#333;text-decoration:none}.btn.active,.btn:active{background-image:none;outline:0;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{pointer-events:none;cursor:not-allowed;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none;opacity:.65}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default.active,.btn-default.focus,.btn-default:active,.btn-default:focus,.btn-default:hover,.open>.dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default.active,.btn-default:active,.open>.dropdown-toggle.btn-default{background-image:none}.btn-default.disabled,.btn-default.disabled.active,.btn-default.disabled.focus,.btn-default.disabled:active,.btn-default.disabled:focus,.btn-default.disabled:hover,.btn-default[disabled],.btn-default[disabled].active,.btn-default[disabled].focus,.btn-default[disabled]:active,.btn-default[disabled]:focus,.btn-default[disabled]:hover,fieldset[disabled] .btn-default,fieldset[disabled] .btn-default.active,fieldset[disabled] .btn-default.focus,fieldset[disabled] .btn-default:active,fieldset[disabled] .btn-default:focus,fieldset[disabled] .btn-default:hover{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#337ab7;border-color:#2e6da4}.btn-primary.active,.btn-primary.focus,.btn-primary:active,.btn-primary:focus,.btn-primary:hover,.open>.dropdown-toggle.btn-primary{color:#fff;background-color:#286090;border-color:#204d74}.btn-primary.active,.btn-primary:active,.open>.dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled,.btn-primary.disabled.active,.btn-primary.disabled.focus,.btn-primary.disabled:active,.btn-primary.disabled:focus,.btn-primary.disabled:hover,.btn-primary[disabled],.btn-primary[disabled].active,.btn-primary[disabled].focus,.btn-primary[disabled]:active,.btn-primary[disabled]:focus,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary,fieldset[disabled] .btn-primary.active,fieldset[disabled] .btn-primary.focus,fieldset[disabled] .btn-primary:active,fieldset[disabled] .btn-primary:focus,fieldset[disabled] .btn-primary:hover{background-color:#337ab7;border-color:#2e6da4}.btn-primary .badge{color:#337ab7;background-color:#fff}.btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success.active,.btn-success.focus,.btn-success:active,.btn-success:focus,.btn-success:hover,.open>.dropdown-toggle.btn-success{color:#fff;background-color:#449d44;border-color:#398439}.btn-success.active,.btn-success:active,.open>.dropdown-toggle.btn-success{background-image:none}.btn-success.disabled,.btn-success.disabled.active,.btn-success.disabled.focus,.btn-success.disabled:active,.btn-success.disabled:focus,.btn-success.disabled:hover,.btn-success[disabled],.btn-success[disabled].active,.btn-success[disabled].focus,.btn-success[disabled]:active,.btn-success[disabled]:focus,.btn-success[disabled]:hover,fieldset[disabled] .btn-success,fieldset[disabled] .btn-success.active,fieldset[disabled] .btn-success.focus,fieldset[disabled] .btn-success:active,fieldset[disabled] .btn-success:focus,fieldset[disabled] .btn-success:hover{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info.active,.btn-info.focus,.btn-info:active,.btn-info:focus,.btn-info:hover,.open>.dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info.active,.btn-info:active,.open>.dropdown-toggle.btn-info{background-image:none}.btn-info.disabled,.btn-info.disabled.active,.btn-info.disabled.focus,.btn-info.disabled:active,.btn-info.disabled:focus,.btn-info.disabled:hover,.btn-info[disabled],.btn-info[disabled].active,.btn-info[disabled].focus,.btn-info[disabled]:active,.btn-info[disabled]:focus,.btn-info[disabled]:hover,fieldset[disabled] .btn-info,fieldset[disabled] .btn-info.active,fieldset[disabled] .btn-info.focus,fieldset[disabled] .btn-info:active,fieldset[disabled] .btn-info:focus,fieldset[disabled] .btn-info:hover{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning.active,.btn-warning.focus,.btn-warning:active,.btn-warning:focus,.btn-warning:hover,.open>.dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning.active,.btn-warning:active,.open>.dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled,.btn-warning.disabled.active,.btn-warning.disabled.focus,.btn-warning.disabled:active,.btn-warning.disabled:focus,.btn-warning.disabled:hover,.btn-warning[disabled],.btn-warning[disabled].active,.btn-warning[disabled].focus,.btn-warning[disabled]:active,.btn-warning[disabled]:focus,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning,fieldset[disabled] .btn-warning.active,fieldset[disabled] .btn-warning.focus,fieldset[disabled] .btn-warning:active,fieldset[disabled] .btn-warning:focus,fieldset[disabled] .btn-warning:hover{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger.active,.btn-danger.focus,.btn-danger:active,.btn-danger:focus,.btn-danger:hover,.open>.dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger.active,.btn-danger:active,.open>.dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled,.btn-danger.disabled.active,.btn-danger.disabled.focus,.btn-danger.disabled:active,.btn-danger.disabled:focus,.btn-danger.disabled:hover,.btn-danger[disabled],.btn-danger[disabled].active,.btn-danger[disabled].focus,.btn-danger[disabled]:active,.btn-danger[disabled]:focus,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger,fieldset[disabled] .btn-danger.active,fieldset[disabled] .btn-danger.focus,fieldset[disabled] .btn-danger:active,fieldset[disabled] .btn-danger:focus,fieldset[disabled] .btn-danger:hover{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{font-weight:400;color:#337ab7;border-radius:0}.btn-link,.btn-link.active,.btn-link:active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:active,.btn-link:focus,.btn-link:hover{border-color:transparent}.btn-link:focus,.btn-link:hover{color:#23527c;text-decoration:underline;background-color:transparent}.btn-link[disabled]:focus,.btn-link[disabled]:hover,fieldset[disabled] .btn-link:focus,fieldset[disabled] .btn-link:hover{color:#777;text-decoration:none}.btn-group-lg>.btn,.btn-lg{padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}.btn-group-sm>.btn,.btn-sm{padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.btn-group-xs>.btn,.btn-xs{padding:1px 5px;font-size:12px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:5px}input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{width:100%}.fade{opacity:0;-webkit-transition:opacity .15s linear;-o-transition:opacity .15s linear;transition:opacity .15s linear}.fade.in{opacity:1}.collapse{display:none}.collapse.in{display:block}tr.collapse.in{display:table-row}tbody.collapse.in{display:table-row-group}.collapsing{position:relative;height:0;overflow:hidden;-webkit-transition-timing-function:ease;-o-transition-timing-function:ease;transition-timing-function:ease;-webkit-transition-duration:.35s;-o-transition-duration:.35s;transition-duration:.35s;-webkit-transition-property:height,visibility;-o-transition-property:height,visibility;transition-property:height,visibility}.caret{display:inline-block;width:0;height:0;margin-left:2px;vertical-align:middle;border-top:4px dashed;border-right:4px solid transparent;border-left:4px solid transparent}.dropdown,.dropup{position:relative}.dropdown-toggle:focus{outline:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;font-size:14px;text-align:left;list-style:none;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #ccc;border:1px solid rgba(0,0,0,.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,.175);box-shadow:0 6px 12px rgba(0,0,0,.175)}.dropdown-menu.pull-right{right:0;left:auto}.dropdown-menu .divider{height:1px;margin:9px 0;overflow:hidden;background-color:#e5e5e5}.dropdown-menu>li>a{display:block;padding:3px 20px;clear:both;font-weight:400;line-height:1.42857143;color:#333;white-space:nowrap}.dropdown-menu>li>a:focus,.dropdown-menu>li>a:hover{color:#262626;text-decoration:none;background-color:#f5f5f5}.dropdown-menu>.active>a,.dropdown-menu>.active>a:focus,.dropdown-menu>.active>a:hover{color:#fff;text-decoration:none;background-color:#337ab7;outline:0}.dropdown-menu>.disabled>a,.dropdown-menu>.disabled>a:focus,.dropdown-menu>.disabled>a:hover{color:#777}.dropdown-menu>.disabled>a:focus,.dropdown-menu>.disabled>a:hover{text-decoration:none;cursor:not-allowed;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled=false)}.open>.dropdown-menu{display:block}.open>a{outline:0}.dropdown-menu-right{right:0;left:auto}.dropdown-menu-left{right:auto;left:0}.dropdown-header{display:block;padding:3px 20px;font-size:12px;line-height:1.42857143;color:#777;white-space:nowrap}.dropdown-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:990}.pull-right>.dropdown-menu{right:0;left:auto}.dropup .caret,.navbar-fixed-bottom .dropdown .caret{content:"";border-top:0;border-bottom:4px solid}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu{top:auto;bottom:100%;margin-bottom:2px}@media (min-width:768px){.navbar-right .dropdown-menu{right:0;left:auto}.navbar-right .dropdown-menu-left{right:auto;left:0}}.btn-group,.btn-group-vertical{position:relative;display:inline-block;vertical-align:middle}.btn-group-vertical>.btn,.btn-group>.btn{position:relative;float:left}.btn-group-vertical>.btn.active,.btn-group-vertical>.btn:active,.btn-group-vertical>.btn:focus,.btn-group-vertical>.btn:hover,.btn-group>.btn.active,.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:2}.btn-group .btn+.btn,.btn-group .btn+.btn-group,.btn-group .btn-group+.btn,.btn-group .btn-group+.btn-group{margin-left:-1px}.btn-toolbar{margin-left:-5px}.btn-toolbar .btn-group,.btn-toolbar .input-group{float:left}.btn-toolbar>.btn,.btn-toolbar>.btn-group,.btn-toolbar>.input-group{margin-left:5px}.btn-group>.btn:not(:first-child):not(:last-child):not(.dropdown-toggle){border-radius:0}.btn-group>.btn:first-child{margin-left:0}.btn-group>.btn:first-child:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn:last-child:not(:first-child),.btn-group>.dropdown-toggle:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.btn-group>.btn-group{float:left}.btn-group>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:last-child:not(:first-child)>.btn:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.btn-group .dropdown-toggle:active,.btn-group.open .dropdown-toggle{outline:0}.btn-group>.btn+.dropdown-toggle{padding-right:8px;padding-left:8px}.btn-group>.btn-lg+.dropdown-toggle{padding-right:12px;padding-left:12px}.btn-group.open .dropdown-toggle{-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn-group.open .dropdown-toggle.btn-link{-webkit-box-shadow:none;box-shadow:none}.btn .caret{margin-left:0}.btn-lg .caret{border-width:5px 5px 0;border-bottom-width:0}.dropup .btn-lg .caret{border-width:0 5px 5px}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group,.btn-group-vertical>.btn-group>.btn{display:block;float:none;width:100%;max-width:100%}.btn-group-vertical>.btn-group>.btn{float:none}.btn-group-vertical>.btn+.btn,.btn-group-vertical>.btn+.btn-group,.btn-group-vertical>.btn-group+.btn,.btn-group-vertical>.btn-group+.btn-group{margin-top:-1px;margin-left:0}.btn-group-vertical>.btn:not(:first-child):not(:last-child){border-radius:0}.btn-group-vertical>.btn:first-child:not(:last-child){border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn:last-child:not(:first-child){border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:4px}.btn-group-vertical>.btn-group:not(:first-child):not(:last-child)>.btn{border-radius:0}.btn-group-vertical>.btn-group:first-child:not(:last-child)>.btn:last-child,.btn-group-vertical>.btn-group:first-child:not(:last-child)>.dropdown-toggle{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:last-child:not(:first-child)>.btn:first-child{border-top-left-radius:0;border-top-right-radius:0}.btn-group-justified{display:table;width:100%;table-layout:fixed;border-collapse:separate}.btn-group-justified>.btn,.btn-group-justified>.btn-group{display:table-cell;float:none;width:1%}.btn-group-justified>.btn-group .btn{width:100%}.btn-group-justified>.btn-group .dropdown-menu{left:auto}[data-toggle=buttons]>.btn input[type=checkbox],[data-toggle=buttons]>.btn input[type=radio],[data-toggle=buttons]>.btn-group>.btn input[type=checkbox],[data-toggle=buttons]>.btn-group>.btn input[type=radio]{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.input-group{position:relative;display:table;border-collapse:separate}.input-group[class*=col-]{float:none;padding-right:0;padding-left:0}.input-group .form-control{position:relative;z-index:2;float:left;width:100%;margin-bottom:0}.input-group-lg>.form-control,.input-group-lg>.input-group-addon,.input-group-lg>.input-group-btn>.btn{height:46px;padding:10px 16px;font-size:18px;line-height:1.3333333;border-radius:6px}select.input-group-lg>.form-control,select.input-group-lg>.input-group-addon,select.input-group-lg>.input-group-btn>.btn{height:46px;line-height:46px}select[multiple].input-group-lg>.form-control,select[multiple].input-group-lg>.input-group-addon,select[multiple].input-group-lg>.input-group-btn>.btn,textarea.input-group-lg>.form-control,textarea.input-group-lg>.input-group-addon,textarea.input-group-lg>.input-group-btn>.btn{height:auto}.input-group-sm>.form-control,.input-group-sm>.input-group-addon,.input-group-sm>.input-group-btn>.btn{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-group-sm>.form-control,select.input-group-sm>.input-group-addon,select.input-group-sm>.input-group-btn>.btn{height:30px;line-height:30px}select[multiple].input-group-sm>.form-control,select[multiple].input-group-sm>.input-group-addon,select[multiple].input-group-sm>.input-group-btn>.btn,textarea.input-group-sm>.form-control,textarea.input-group-sm>.input-group-addon,textarea.input-group-sm>.input-group-btn>.btn{height:auto}.input-group .form-control,.input-group-addon,.input-group-btn{display:table-cell}.input-group .form-control:not(:first-child):not(:last-child),.input-group-addon:not(:first-child):not(:last-child),.input-group-btn:not(:first-child):not(:last-child){border-radius:0}.input-group-addon,.input-group-btn{width:1%;white-space:nowrap;vertical-align:middle}.input-group-addon{padding:6px 12px;font-size:14px;font-weight:400;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;border-radius:4px}.input-group-addon.input-sm{padding:5px 10px;font-size:12px;border-radius:3px}.input-group-addon.input-lg{padding:10px 16px;font-size:18px;border-radius:6px}.input-group-addon input[type=checkbox],.input-group-addon input[type=radio]{margin-top:0}.input-group .form-control:first-child,.input-group-addon:first-child,.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group>.btn,.input-group-btn:first-child>.dropdown-toggle,.input-group-btn:last-child>.btn-group:not(:last-child)>.btn,.input-group-btn:last-child>.btn:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.input-group-addon:first-child{border-right:0}.input-group .form-control:last-child,.input-group-addon:last-child,.input-group-btn:first-child>.btn-group:not(:first-child)>.btn,.input-group-btn:first-child>.btn:not(:first-child),.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group>.btn,.input-group-btn:last-child>.dropdown-toggle{border-top-left-radius:0;border-bottom-left-radius:0}.input-group-addon:last-child{border-left:0}.input-group-btn{position:relative;font-size:0;white-space:nowrap}.input-group-btn>.btn{position:relative}.input-group-btn>.btn+.btn{margin-left:-1px}.input-group-btn>.btn:active,.input-group-btn>.btn:focus,.input-group-btn>.btn:hover{z-index:2}.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group{margin-right:-1px}.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group{margin-left:-1px}.nav{padding-left:0;margin-bottom:0;list-style:none}.nav>li{position:relative;display:block}.nav>li>a{position:relative;display:block;padding:10px 15px}.nav>li>a:focus,.nav>li>a:hover{text-decoration:none;background-color:#eee}.nav>li.disabled>a{color:#777}.nav>li.disabled>a:focus,.nav>li.disabled>a:hover{color:#777;text-decoration:none;cursor:not-allowed;background-color:transparent}.nav .open>a,.nav .open>a:focus,.nav .open>a:hover{background-color:#eee;border-color:#337ab7}.nav .nav-divider{height:1px;margin:9px 0;overflow:hidden;background-color:#e5e5e5}.nav>li>a>img{max-width:none}.nav-tabs{border-bottom:1px solid #ddd}.nav-tabs>li{float:left;margin-bottom:-1px}.nav-tabs>li>a{margin-right:2px;line-height:1.42857143;border:1px solid transparent;border-radius:4px 4px 0 0}.nav-tabs>li>a:hover{border-color:#eee #eee #ddd}.nav-tabs>li.active>a,.nav-tabs>li.active>a:focus,.nav-tabs>li.active>a:hover{color:#555;cursor:default;background-color:#fff;border:1px solid #ddd;border-bottom-color:transparent}.nav-tabs.nav-justified{width:100%;border-bottom:0}.nav-tabs.nav-justified>li{float:none}.nav-tabs.nav-justified>li>a{margin-bottom:5px;text-align:center}.nav-tabs.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media (min-width:768px){.nav-tabs.nav-justified>li{display:table-cell;width:1%}.nav-tabs.nav-justified>li>a{margin-bottom:0}}.nav-tabs.nav-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:focus,.nav-tabs.nav-justified>.active>a:hover{border:1px solid #ddd}@media (min-width:768px){.nav-tabs.nav-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs.nav-justified>.active>a,.nav-tabs.nav-justified>.active>a:focus,.nav-tabs.nav-justified>.active>a:hover{border-bottom-color:#fff}}.nav-pills>li{float:left}.nav-pills>li>a{border-radius:4px}.nav-pills>li+li{margin-left:2px}.nav-pills>li.active>a,.nav-pills>li.active>a:focus,.nav-pills>li.active>a:hover{color:#fff;background-color:#337ab7}.nav-stacked>li{float:none}.nav-stacked>li+li{margin-top:2px;margin-left:0}.nav-justified{width:100%}.nav-justified>li{float:none}.nav-justified>li>a{margin-bottom:5px;text-align:center}.nav-justified>.dropdown .dropdown-menu{top:auto;left:auto}@media (min-width:768px){.nav-justified>li{display:table-cell;width:1%}.nav-justified>li>a{margin-bottom:0}}.nav-tabs-justified{border-bottom:0}.nav-tabs-justified>li>a{margin-right:0;border-radius:4px}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:focus,.nav-tabs-justified>.active>a:hover{border:1px solid #ddd}@media (min-width:768px){.nav-tabs-justified>li>a{border-bottom:1px solid #ddd;border-radius:4px 4px 0 0}.nav-tabs-justified>.active>a,.nav-tabs-justified>.active>a:focus,.nav-tabs-justified>.active>a:hover{border-bottom-color:#fff}}.tab-content>.tab-pane{display:none}.tab-content>.active{display:block}.nav-tabs .dropdown-menu{margin-top:-1px;border-top-left-radius:0;border-top-right-radius:0}.navbar{position:relative;min-height:50px;margin-bottom:20px;border:1px solid transparent}@media (min-width:768px){.navbar{border-radius:4px}}@media (min-width:768px){.navbar-header{float:left}}.navbar-collapse{padding-right:15px;padding-left:15px;overflow-x:visible;-webkit-overflow-scrolling:touch;border-top:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.1);box-shadow:inset 0 1px 0 rgba(255,255,255,.1)}.navbar-collapse.in{overflow-y:auto}@media (min-width:768px){.navbar-collapse{width:auto;border-top:0;-webkit-box-shadow:none;box-shadow:none}.navbar-collapse.collapse{display:block!important;height:auto!important;padding-bottom:0;overflow:visible!important}.navbar-collapse.in{overflow-y:visible}.navbar-fixed-bottom .navbar-collapse,.navbar-fixed-top .navbar-collapse,.navbar-static-top .navbar-collapse{padding-right:0;padding-left:0}}.navbar-fixed-bottom .navbar-collapse,.navbar-fixed-top .navbar-collapse{max-height:340px}@media (max-device-width:480px)and (orientation:landscape){.navbar-fixed-bottom .navbar-collapse,.navbar-fixed-top .navbar-collapse{max-height:200px}}.container-fluid>.navbar-collapse,.container-fluid>.navbar-header,.container>.navbar-collapse,.container>.navbar-header{margin-right:-15px;margin-left:-15px}@media (min-width:768px){.container-fluid>.navbar-collapse,.container-fluid>.navbar-header,.container>.navbar-collapse,.container>.navbar-header{margin-right:0;margin-left:0}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width:768px){.navbar-static-top{border-radius:0}}.navbar-fixed-bottom,.navbar-fixed-top{position:fixed;right:0;left:0;z-index:1030}@media (min-width:768px){.navbar-fixed-bottom,.navbar-fixed-top{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}.navbar-brand{float:left;height:50px;padding:15px 15px;font-size:18px;line-height:20px}.navbar-brand:focus,.navbar-brand:hover{text-decoration:none}.navbar-brand>img{display:block}@media (min-width:768px){.navbar>.container .navbar-brand,.navbar>.container-fluid .navbar-brand{margin-left:-15px}}.navbar-toggle{position:relative;float:right;padding:9px 10px;margin-top:8px;margin-right:15px;margin-bottom:8px;background-color:transparent;background-image:none;border:1px solid transparent;border-radius:4px}.navbar-toggle:focus{outline:0}.navbar-toggle .icon-bar{display:block;width:22px;height:2px;border-radius:1px}.navbar-toggle .icon-bar+.icon-bar{margin-top:4px}@media (min-width:768px){.navbar-toggle{display:none}}.navbar-nav{margin:7.5px -15px}.navbar-nav>li>a{padding-top:10px;padding-bottom:10px;line-height:20px}@media (max-width:767px){.navbar-nav .open .dropdown-menu{position:static;float:none;width:auto;margin-top:0;background-color:transparent;border:0;-webkit-box-shadow:none;box-shadow:none}.navbar-nav .open .dropdown-menu .dropdown-header,.navbar-nav .open .dropdown-menu>li>a{padding:5px 15px 5px 25px}.navbar-nav .open .dropdown-menu>li>a{line-height:20px}.navbar-nav .open .dropdown-menu>li>a:focus,.navbar-nav .open .dropdown-menu>li>a:hover{background-image:none}}@media (min-width:768px){.navbar-nav{float:left;margin:0}.navbar-nav>li{float:left}.navbar-nav>li>a{padding-top:15px;padding-bottom:15px}}.navbar-form{padding:10px 15px;margin-top:8px;margin-right:-15px;margin-bottom:8px;margin-left:-15px;border-top:1px solid transparent;border-bottom:1px solid transparent;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.1),0 1px 0 rgba(255,255,255,.1);box-shadow:inset 0 1px 0 rgba(255,255,255,.1),0 1px 0 rgba(255,255,255,.1)}@media (min-width:768px){.navbar-form .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.navbar-form .form-control{display:inline-block;width:auto;vertical-align:middle}.navbar-form .form-control-static{display:inline-block}.navbar-form .input-group{display:inline-table;vertical-align:middle}.navbar-form .input-group .form-control,.navbar-form .input-group .input-group-addon,.navbar-form .input-group .input-group-btn{width:auto}.navbar-form .input-group>.form-control{width:100%}.navbar-form .control-label{margin-bottom:0;vertical-align:middle}.navbar-form .checkbox,.navbar-form .radio{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.navbar-form .checkbox label,.navbar-form .radio label{padding-left:0}.navbar-form .checkbox input[type=checkbox],.navbar-form .radio input[type=radio]{position:relative;margin-left:0}.navbar-form .has-feedback .form-control-feedback{top:0}}@media (max-width:767px){.navbar-form .form-group{margin-bottom:5px}.navbar-form .form-group:last-child{margin-bottom:0}}@media (min-width:768px){.navbar-form{width:auto;padding-top:0;padding-bottom:0;margin-right:0;margin-left:0;border:0;-webkit-box-shadow:none;box-shadow:none}}.navbar-nav>li>.dropdown-menu{margin-top:0;border-top-left-radius:0;border-top-right-radius:0}.navbar-fixed-bottom .navbar-nav>li>.dropdown-menu{margin-bottom:0;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-btn{margin-top:8px;margin-bottom:8px}.navbar-btn.btn-sm{margin-top:10px;margin-bottom:10px}.navbar-btn.btn-xs{margin-top:14px;margin-bottom:14px}.navbar-text{margin-top:15px;margin-bottom:15px}@media (min-width:768px){.navbar-text{float:left;margin-right:15px;margin-left:15px}}@media (min-width:768px){.navbar-left{float:left!important}.navbar-right{float:right!important;margin-right:-15px}.navbar-right~.navbar-right{margin-right:0}}.navbar-default{background-color:#f8f8f8;border-color:#e7e7e7}.navbar-default .navbar-brand{color:#777}.navbar-default .navbar-brand:focus,.navbar-default .navbar-brand:hover{color:#5e5e5e;background-color:transparent}.navbar-default .navbar-text{color:#777}.navbar-default .navbar-nav>li>a{color:#777}.navbar-default .navbar-nav>li>a:focus,.navbar-default .navbar-nav>li>a:hover{color:#333;background-color:transparent}.navbar-default .navbar-nav>.active>a,.navbar-default .navbar-nav>.active>a:focus,.navbar-default .navbar-nav>.active>a:hover{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav>.disabled>a,.navbar-default .navbar-nav>.disabled>a:focus,.navbar-default .navbar-nav>.disabled>a:hover{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#ddd}.navbar-default .navbar-toggle:focus,.navbar-default .navbar-toggle:hover{background-color:#ddd}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#e7e7e7}.navbar-default .navbar-nav>.open>a,.navbar-default .navbar-nav>.open>a:focus,.navbar-default .navbar-nav>.open>a:hover{color:#555;background-color:#e7e7e7}@media (max-width:767px){.navbar-default .navbar-nav .open .dropdown-menu>li>a{color:#777}.navbar-default .navbar-nav .open .dropdown-menu>li>a:focus,.navbar-default .navbar-nav .open .dropdown-menu>li>a:hover{color:#333;background-color:transparent}.navbar-default .navbar-nav .open .dropdown-menu>.active>a,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:focus,.navbar-default .navbar-nav .open .dropdown-menu>.active>a:hover{color:#555;background-color:#e7e7e7}.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:focus,.navbar-default .navbar-nav .open .dropdown-menu>.disabled>a:hover{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#777}.navbar-default .navbar-link:hover{color:#333}.navbar-default .btn-link{color:#777}.navbar-default .btn-link:focus,.navbar-default .btn-link:hover{color:#333}.navbar-default .btn-link[disabled]:focus,.navbar-default .btn-link[disabled]:hover,fieldset[disabled] .navbar-default .btn-link:focus,fieldset[disabled] .navbar-default .btn-link:hover{color:#ccc}.navbar-inverse{background-color:#222;border-color:#080808}.navbar-inverse .navbar-brand{color:#9d9d9d}.navbar-inverse .navbar-brand:focus,.navbar-inverse .navbar-brand:hover{color:#fff;background-color:transparent}.navbar-inverse .navbar-text{color:#9d9d9d}.navbar-inverse .navbar-nav>li>a{color:#9d9d9d}.navbar-inverse .navbar-nav>li>a:focus,.navbar-inverse .navbar-nav>li>a:hover{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav>.active>a,.navbar-inverse .navbar-nav>.active>a:focus,.navbar-inverse .navbar-nav>.active>a:hover{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav>.disabled>a,.navbar-inverse .navbar-nav>.disabled>a:focus,.navbar-inverse .navbar-nav>.disabled>a:hover{color:#444;background-color:transparent}.navbar-inverse .navbar-toggle{border-color:#333}.navbar-inverse .navbar-toggle:focus,.navbar-inverse .navbar-toggle:hover{background-color:#333}.navbar-inverse .navbar-toggle .icon-bar{background-color:#fff}.navbar-inverse .navbar-collapse,.navbar-inverse .navbar-form{border-color:#101010}.navbar-inverse .navbar-nav>.open>a,.navbar-inverse .navbar-nav>.open>a:focus,.navbar-inverse .navbar-nav>.open>a:hover{color:#fff;background-color:#080808}@media (max-width:767px){.navbar-inverse .navbar-nav .open .dropdown-menu>.dropdown-header{border-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu .divider{background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a{color:#9d9d9d}.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:focus,.navbar-inverse .navbar-nav .open .dropdown-menu>li>a:hover{color:#fff;background-color:transparent}.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:focus,.navbar-inverse .navbar-nav .open .dropdown-menu>.active>a:hover{color:#fff;background-color:#080808}.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:focus,.navbar-inverse .navbar-nav .open .dropdown-menu>.disabled>a:hover{color:#444;background-color:transparent}}.navbar-inverse .navbar-link{color:#9d9d9d}.navbar-inverse .navbar-link:hover{color:#fff}.navbar-inverse .btn-link{color:#9d9d9d}.navbar-inverse .btn-link:focus,.navbar-inverse .btn-link:hover{color:#fff}.navbar-inverse .btn-link[disabled]:focus,.navbar-inverse .btn-link[disabled]:hover,fieldset[disabled] .navbar-inverse .btn-link:focus,fieldset[disabled] .navbar-inverse .btn-link:hover{color:#444}.breadcrumb{padding:8px 15px;margin-bottom:20px;list-style:none;background-color:#f5f5f5;border-radius:4px}.breadcrumb>li{display:inline-block}.breadcrumb>li+li:before{padding:0 5px;color:#ccc;content:"/\00a0"}.breadcrumb>.active{color:#777}.pagination{display:inline-block;padding-left:0;margin:20px 0;border-radius:4px}.pagination>li{display:inline}.pagination>li>a,.pagination>li>span{position:relative;float:left;padding:6px 12px;margin-left:-1px;line-height:1.42857143;color:#337ab7;text-decoration:none;background-color:#fff;border:1px solid #ddd}.pagination>li:first-child>a,.pagination>li:first-child>span{margin-left:0;border-top-left-radius:4px;border-bottom-left-radius:4px}.pagination>li:last-child>a,.pagination>li:last-child>span{border-top-right-radius:4px;border-bottom-right-radius:4px}.pagination>li>a:focus,.pagination>li>a:hover,.pagination>li>span:focus,.pagination>li>span:hover{color:#23527c;background-color:#eee;border-color:#ddd}.pagination>.active>a,.pagination>.active>a:focus,.pagination>.active>a:hover,.pagination>.active>span,.pagination>.active>span:focus,.pagination>.active>span:hover{z-index:2;color:#fff;cursor:default;background-color:#337ab7;border-color:#337ab7}.pagination>.disabled>a,.pagination>.disabled>a:focus,.pagination>.disabled>a:hover,.pagination>.disabled>span,.pagination>.disabled>span:focus,.pagination>.disabled>span:hover{color:#777;cursor:not-allowed;background-color:#fff;border-color:#ddd}.pagination-lg>li>a,.pagination-lg>li>span{padding:10px 16px;font-size:18px}.pagination-lg>li:first-child>a,.pagination-lg>li:first-child>span{border-top-left-radius:6px;border-bottom-left-radius:6px}.pagination-lg>li:last-child>a,.pagination-lg>li:last-child>span{border-top-right-radius:6px;border-bottom-right-radius:6px}.pagination-sm>li>a,.pagination-sm>li>span{padding:5px 10px;font-size:12px}.pagination-sm>li:first-child>a,.pagination-sm>li:first-child>span{border-top-left-radius:3px;border-bottom-left-radius:3px}.pagination-sm>li:last-child>a,.pagination-sm>li:last-child>span{border-top-right-radius:3px;border-bottom-right-radius:3px}.pager{padding-left:0;margin:20px 0;text-align:center;list-style:none}.pager li{display:inline}.pager li>a,.pager li>span{display:inline-block;padding:5px 14px;background-color:#fff;border:1px solid #ddd;border-radius:15px}.pager li>a:focus,.pager li>a:hover{text-decoration:none;background-color:#eee}.pager .next>a,.pager .next>span{float:right}.pager .previous>a,.pager .previous>span{float:left}.pager .disabled>a,.pager .disabled>a:focus,.pager .disabled>a:hover,.pager .disabled>span{color:#777;cursor:not-allowed;background-color:#fff}.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:focus,a.label:hover{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:focus,.label-default[href]:hover{background-color:#5e5e5e}.label-primary{background-color:#337ab7}.label-primary[href]:focus,.label-primary[href]:hover{background-color:#286090}.label-success{background-color:#5cb85c}.label-success[href]:focus,.label-success[href]:hover{background-color:#449d44}.label-info{background-color:#5bc0de}.label-info[href]:focus,.label-info[href]:hover{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:focus,.label-warning[href]:hover{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:focus,.label-danger[href]:hover{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:12px;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;background-color:#777;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-group-xs>.btn .badge,.btn-xs .badge{top:0;padding:1px 5px}a.badge:focus,a.badge:hover{color:#fff;text-decoration:none;cursor:pointer}.list-group-item.active>.badge,.nav-pills>.active>a>.badge{color:#337ab7;background-color:#fff}.list-group-item>.badge{float:right}.list-group-item>.badge+.badge{margin-right:5px}.nav-pills>li>a>.badge{margin-left:3px}.jumbotron{padding:30px 15px;margin-bottom:30px;color:inherit;background-color:#eee}.jumbotron .h1,.jumbotron h1{color:inherit}.jumbotron p{margin-bottom:15px;font-size:21px;font-weight:200}.jumbotron>hr{border-top-color:#d5d5d5}.container .jumbotron,.container-fluid .jumbotron{border-radius:6px}.jumbotron .container{max-width:100%}@media screen and (min-width:768px){.jumbotron{padding:48px 0}.container .jumbotron,.container-fluid .jumbotron{padding-right:60px;padding-left:60px}.jumbotron .h1,.jumbotron h1{font-size:63px}}.thumbnail{display:block;padding:4px;margin-bottom:20px;line-height:1.42857143;background-color:#fff;border:1px solid #ddd;border-radius:4px;-webkit-transition:border .2s ease-in-out;-o-transition:border .2s ease-in-out;transition:border .2s ease-in-out}.thumbnail a>img,.thumbnail>img{margin-right:auto;margin-left:auto}a.thumbnail.active,a.thumbnail:focus,a.thumbnail:hover{border-color:#337ab7}.thumbnail .caption{padding:9px;color:#333}.alert{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.alert h4{margin-top:0;color:inherit}.alert .alert-link{font-weight:700}.alert>p,.alert>ul{margin-bottom:0}.alert>p+p{margin-top:5px}.alert-dismissable,.alert-dismissible{padding-right:35px}.alert-dismissable .close,.alert-dismissible .close{position:relative;top:-2px;right:-21px;color:inherit}.alert-success{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.alert-success hr{border-top-color:#c9e2b3}.alert-success .alert-link{color:#2b542c}.alert-info{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.alert-info hr{border-top-color:#a6e1ec}.alert-info .alert-link{color:#245269}.alert-warning{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.alert-warning hr{border-top-color:#f7e1b5}.alert-warning .alert-link{color:#66512c}.alert-danger{color:#a94442;background-color:#f2dede;border-color:#ebccd1}.alert-danger hr{border-top-color:#e4b9c0}.alert-danger .alert-link{color:#843534}@-webkit-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@-o-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}.progress{height:20px;margin-bottom:20px;overflow:hidden;background-color:#f5f5f5;border-radius:4px;-webkit-box-shadow:inset 0 1px 2px rgba(0,0,0,.1);box-shadow:inset 0 1px 2px rgba(0,0,0,.1)}.progress-bar{float:left;width:0;height:100%;font-size:12px;line-height:20px;color:#fff;text-align:center;background-color:#337ab7;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.15);box-shadow:inset 0 -1px 0 rgba(0,0,0,.15);-webkit-transition:width .6s ease;-o-transition:width .6s ease;transition:width .6s ease}.progress-bar-striped,.progress-striped .progress-bar{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);-webkit-background-size:40px 40px;background-size:40px 40px}.progress-bar.active,.progress.active .progress-bar{-webkit-animation:progress-bar-stripes 2s linear infinite;-o-animation:progress-bar-stripes 2s linear infinite;animation:progress-bar-stripes 2s linear infinite}.progress-bar-success{background-color:#5cb85c}.progress-striped .progress-bar-success{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-info{background-color:#5bc0de}.progress-striped .progress-bar-info{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-warning{background-color:#f0ad4e}.progress-striped .progress-bar-warning{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-danger{background-color:#d9534f}.progress-striped .progress-bar-danger{background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.media{margin-top:15px}.media:first-child{margin-top:0}.media,.media-body{overflow:hidden;zoom:1}.media-body{width:10000px}.media-object{display:block}.media-right,.media>.pull-right{padding-left:10px}.media-left,.media>.pull-left{padding-right:10px}.media-body,.media-left,.media-right{display:table-cell;vertical-align:top}.media-middle{vertical-align:middle}.media-bottom{vertical-align:bottom}.media-heading{margin-top:0;margin-bottom:5px}.media-list{padding-left:0;list-style:none}.list-group{padding-left:0;margin-bottom:20px}.list-group-item{position:relative;display:block;padding:10px 15px;margin-bottom:-1px;background-color:#fff;border:1px solid #ddd}.list-group-item:first-child{border-top-left-radius:4px;border-top-right-radius:4px}.list-group-item:last-child{margin-bottom:0;border-bottom-right-radius:4px;border-bottom-left-radius:4px}a.list-group-item{color:#555}a.list-group-item .list-group-item-heading{color:#333}a.list-group-item:focus,a.list-group-item:hover{color:#555;text-decoration:none;background-color:#f5f5f5}.list-group-item.disabled,.list-group-item.disabled:focus,.list-group-item.disabled:hover{color:#777;cursor:not-allowed;background-color:#eee}.list-group-item.disabled .list-group-item-heading,.list-group-item.disabled:focus .list-group-item-heading,.list-group-item.disabled:hover .list-group-item-heading{color:inherit}.list-group-item.disabled .list-group-item-text,.list-group-item.disabled:focus .list-group-item-text,.list-group-item.disabled:hover .list-group-item-text{color:#777}.list-group-item.active,.list-group-item.active:focus,.list-group-item.active:hover{z-index:2;color:#fff;background-color:#337ab7;border-color:#337ab7}.list-group-item.active .list-group-item-heading,.list-group-item.active .list-group-item-heading>.small,.list-group-item.active .list-group-item-heading>small,.list-group-item.active:focus .list-group-item-heading,.list-group-item.active:focus .list-group-item-heading>.small,.list-group-item.active:focus .list-group-item-heading>small,.list-group-item.active:hover .list-group-item-heading,.list-group-item.active:hover .list-group-item-heading>.small,.list-group-item.active:hover .list-group-item-heading>small{color:inherit}.list-group-item.active .list-group-item-text,.list-group-item.active:focus .list-group-item-text,.list-group-item.active:hover .list-group-item-text{color:#c7ddef}.list-group-item-success{color:#3c763d;background-color:#dff0d8}a.list-group-item-success{color:#3c763d}a.list-group-item-success .list-group-item-heading{color:inherit}a.list-group-item-success:focus,a.list-group-item-success:hover{color:#3c763d;background-color:#d0e9c6}a.list-group-item-success.active,a.list-group-item-success.active:focus,a.list-group-item-success.active:hover{color:#fff;background-color:#3c763d;border-color:#3c763d}.list-group-item-info{color:#31708f;background-color:#d9edf7}a.list-group-item-info{color:#31708f}a.list-group-item-info .list-group-item-heading{color:inherit}a.list-group-item-info:focus,a.list-group-item-info:hover{color:#31708f;background-color:#c4e3f3}a.list-group-item-info.active,a.list-group-item-info.active:focus,a.list-group-item-info.active:hover{color:#fff;background-color:#31708f;border-color:#31708f}.list-group-item-warning{color:#8a6d3b;background-color:#fcf8e3}a.list-group-item-warning{color:#8a6d3b}a.list-group-item-warning .list-group-item-heading{color:inherit}a.list-group-item-warning:focus,a.list-group-item-warning:hover{color:#8a6d3b;background-color:#faf2cc}a.list-group-item-warning.active,a.list-group-item-warning.active:focus,a.list-group-item-warning.active:hover{color:#fff;background-color:#8a6d3b;border-color:#8a6d3b}.list-group-item-danger{color:#a94442;background-color:#f2dede}a.list-group-item-danger{color:#a94442}a.list-group-item-danger .list-group-item-heading{color:inherit}a.list-group-item-danger:focus,a.list-group-item-danger:hover{color:#a94442;background-color:#ebcccc}a.list-group-item-danger.active,a.list-group-item-danger.active:focus,a.list-group-item-danger.active:hover{color:#fff;background-color:#a94442;border-color:#a94442}.list-group-item-heading{margin-top:0;margin-bottom:5px}.list-group-item-text{margin-bottom:0;line-height:1.3}.panel{margin-bottom:20px;background-color:#fff;border:1px solid transparent;border-radius:4px;-webkit-box-shadow:0 1px 1px rgba(0,0,0,.05);box-shadow:0 1px 1px rgba(0,0,0,.05)}.panel-body{padding:15px}.panel-heading{padding:10px 15px;border-bottom:1px solid transparent;border-top-left-radius:3px;border-top-right-radius:3px}.panel-heading>.dropdown .dropdown-toggle{color:inherit}.panel-title{margin-top:0;margin-bottom:0;font-size:16px;color:inherit}.panel-title>.small,.panel-title>.small>a,.panel-title>a,.panel-title>small,.panel-title>small>a{color:inherit}.panel-footer{padding:10px 15px;background-color:#f5f5f5;border-top:1px solid #ddd;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.list-group,.panel>.panel-collapse>.list-group{margin-bottom:0}.panel>.list-group .list-group-item,.panel>.panel-collapse>.list-group .list-group-item{border-width:1px 0;border-radius:0}.panel>.list-group:first-child .list-group-item:first-child,.panel>.panel-collapse>.list-group:first-child .list-group-item:first-child{border-top:0;border-top-left-radius:3px;border-top-right-radius:3px}.panel>.list-group:last-child .list-group-item:last-child,.panel>.panel-collapse>.list-group:last-child .list-group-item:last-child{border-bottom:0;border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel-heading+.list-group .list-group-item:first-child{border-top-width:0}.list-group+.panel-footer{border-top-width:0}.panel>.panel-collapse>.table,.panel>.table,.panel>.table-responsive>.table{margin-bottom:0}.panel>.panel-collapse>.table caption,.panel>.table caption,.panel>.table-responsive>.table caption{padding-right:15px;padding-left:15px}.panel>.table-responsive:first-child>.table:first-child,.panel>.table:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child,.panel>.table:first-child>thead:first-child>tr:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:first-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:first-child,.panel>.table:first-child>thead:first-child>tr:first-child td:first-child,.panel>.table:first-child>thead:first-child>tr:first-child th:first-child{border-top-left-radius:3px}.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>tbody:first-child>tr:first-child th:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table-responsive:first-child>.table:first-child>thead:first-child>tr:first-child th:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child td:last-child,.panel>.table:first-child>tbody:first-child>tr:first-child th:last-child,.panel>.table:first-child>thead:first-child>tr:first-child td:last-child,.panel>.table:first-child>thead:first-child>tr:first-child th:last-child{border-top-right-radius:3px}.panel>.table-responsive:last-child>.table:last-child,.panel>.table:last-child{border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child{border-bottom-right-radius:3px;border-bottom-left-radius:3px}.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:first-child,.panel>.table:last-child>tbody:last-child>tr:last-child td:first-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:first-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:first-child{border-bottom-left-radius:3px}.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table-responsive:last-child>.table:last-child>tfoot:last-child>tr:last-child th:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child td:last-child,.panel>.table:last-child>tbody:last-child>tr:last-child th:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child td:last-child,.panel>.table:last-child>tfoot:last-child>tr:last-child th:last-child{border-bottom-right-radius:3px}.panel>.panel-body+.table,.panel>.panel-body+.table-responsive,.panel>.table+.panel-body,.panel>.table-responsive+.panel-body{border-top:1px solid #ddd}.panel>.table>tbody:first-child>tr:first-child td,.panel>.table>tbody:first-child>tr:first-child th{border-top:0}.panel>.table-bordered,.panel>.table-responsive>.table-bordered{border:0}.panel>.table-bordered>tbody>tr>td:first-child,.panel>.table-bordered>tbody>tr>th:first-child,.panel>.table-bordered>tfoot>tr>td:first-child,.panel>.table-bordered>tfoot>tr>th:first-child,.panel>.table-bordered>thead>tr>td:first-child,.panel>.table-bordered>thead>tr>th:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:first-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:first-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:first-child,.panel>.table-responsive>.table-bordered>thead>tr>td:first-child,.panel>.table-responsive>.table-bordered>thead>tr>th:first-child{border-left:0}.panel>.table-bordered>tbody>tr>td:last-child,.panel>.table-bordered>tbody>tr>th:last-child,.panel>.table-bordered>tfoot>tr>td:last-child,.panel>.table-bordered>tfoot>tr>th:last-child,.panel>.table-bordered>thead>tr>td:last-child,.panel>.table-bordered>thead>tr>th:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>td:last-child,.panel>.table-responsive>.table-bordered>tbody>tr>th:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>td:last-child,.panel>.table-responsive>.table-bordered>tfoot>tr>th:last-child,.panel>.table-responsive>.table-bordered>thead>tr>td:last-child,.panel>.table-responsive>.table-bordered>thead>tr>th:last-child{border-right:0}.panel>.table-bordered>tbody>tr:first-child>td,.panel>.table-bordered>tbody>tr:first-child>th,.panel>.table-bordered>thead>tr:first-child>td,.panel>.table-bordered>thead>tr:first-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:first-child>th,.panel>.table-responsive>.table-bordered>thead>tr:first-child>td,.panel>.table-responsive>.table-bordered>thead>tr:first-child>th{border-bottom:0}.panel>.table-bordered>tbody>tr:last-child>td,.panel>.table-bordered>tbody>tr:last-child>th,.panel>.table-bordered>tfoot>tr:last-child>td,.panel>.table-bordered>tfoot>tr:last-child>th,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>td,.panel>.table-responsive>.table-bordered>tbody>tr:last-child>th,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>td,.panel>.table-responsive>.table-bordered>tfoot>tr:last-child>th{border-bottom:0}.panel>.table-responsive{margin-bottom:0;border:0}.panel-group{margin-bottom:20px}.panel-group .panel{margin-bottom:0;border-radius:4px}.panel-group .panel+.panel{margin-top:5px}.panel-group .panel-heading{border-bottom:0}.panel-group .panel-heading+.panel-collapse>.list-group,.panel-group .panel-heading+.panel-collapse>.panel-body{border-top:1px solid #ddd}.panel-group .panel-footer{border-top:0}.panel-group .panel-footer+.panel-collapse .panel-body{border-bottom:1px solid #ddd}.panel-default{border-color:#ddd}.panel-default>.panel-heading{color:#333;background-color:#f5f5f5;border-color:#ddd}.panel-default>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ddd}.panel-default>.panel-heading .badge{color:#f5f5f5;background-color:#333}.panel-default>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ddd}.panel-primary{border-color:#337ab7}.panel-primary>.panel-heading{color:#fff;background-color:#337ab7;border-color:#337ab7}.panel-primary>.panel-heading+.panel-collapse>.panel-body{border-top-color:#337ab7}.panel-primary>.panel-heading .badge{color:#337ab7;background-color:#fff}.panel-primary>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#337ab7}.panel-success{border-color:#d6e9c6}.panel-success>.panel-heading{color:#3c763d;background-color:#dff0d8;border-color:#d6e9c6}.panel-success>.panel-heading+.panel-collapse>.panel-body{border-top-color:#d6e9c6}.panel-success>.panel-heading .badge{color:#dff0d8;background-color:#3c763d}.panel-success>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#d6e9c6}.panel-info{border-color:#bce8f1}.panel-info>.panel-heading{color:#31708f;background-color:#d9edf7;border-color:#bce8f1}.panel-info>.panel-heading+.panel-collapse>.panel-body{border-top-color:#bce8f1}.panel-info>.panel-heading .badge{color:#d9edf7;background-color:#31708f}.panel-info>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#bce8f1}.panel-warning{border-color:#faebcc}.panel-warning>.panel-heading{color:#8a6d3b;background-color:#fcf8e3;border-color:#faebcc}.panel-warning>.panel-heading+.panel-collapse>.panel-body{border-top-color:#faebcc}.panel-warning>.panel-heading .badge{color:#fcf8e3;background-color:#8a6d3b}.panel-warning>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#faebcc}.panel-danger{border-color:#ebccd1}.panel-danger>.panel-heading{color:#a94442;background-color:#f2dede;border-color:#ebccd1}.panel-danger>.panel-heading+.panel-collapse>.panel-body{border-top-color:#ebccd1}.panel-danger>.panel-heading .badge{color:#f2dede;background-color:#a94442}.panel-danger>.panel-footer+.panel-collapse>.panel-body{border-bottom-color:#ebccd1}.embed-responsive{position:relative;display:block;height:0;padding:0;overflow:hidden}.embed-responsive .embed-responsive-item,.embed-responsive embed,.embed-responsive iframe,.embed-responsive object,.embed-responsive video{position:absolute;top:0;bottom:0;left:0;width:100%;height:100%;border:0}.embed-responsive-16by9{padding-bottom:56.25%}.embed-responsive-4by3{padding-bottom:75%}.well{min-height:20px;padding:19px;margin-bottom:20px;background-color:#f5f5f5;border:1px solid #e3e3e3;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.05);box-shadow:inset 0 1px 1px rgba(0,0,0,.05)}.well blockquote{border-color:#ddd;border-color:rgba(0,0,0,.15)}.well-lg{padding:24px;border-radius:6px}.well-sm{padding:9px;border-radius:3px}.close{float:right;font-size:21px;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;filter:alpha(opacity=20);opacity:.2}.close:focus,.close:hover{color:#000;text-decoration:none;cursor:pointer;filter:alpha(opacity=50);opacity:.5}button.close{-webkit-appearance:none;padding:0;cursor:pointer;background:0 0;border:0}.modal-open{overflow:hidden}.modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1050;display:none;overflow:hidden;-webkit-overflow-scrolling:touch;outline:0}.modal.fade .modal-dialog{-webkit-transition:-webkit-transform .3s ease-out;-o-transition:-o-transform .3s ease-out;transition:transform .3s ease-out;-webkit-transform:translate(0,-25%);-ms-transform:translate(0,-25%);-o-transform:translate(0,-25%);transform:translate(0,-25%)}.modal.in .modal-dialog{-webkit-transform:translate(0,0);-ms-transform:translate(0,0);-o-transform:translate(0,0);transform:translate(0,0)}.modal-open .modal{overflow-x:hidden;overflow-y:auto}.modal-dialog{position:relative;width:auto;margin:10px}.modal-content{position:relative;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #999;border:1px solid rgba(0,0,0,.2);border-radius:6px;outline:0;-webkit-box-shadow:0 3px 9px rgba(0,0,0,.5);box-shadow:0 3px 9px rgba(0,0,0,.5)}.modal-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1040;background-color:#000}.modal-backdrop.fade{filter:alpha(opacity=0);opacity:0}.modal-backdrop.in{filter:alpha(opacity=50);opacity:.5}.modal-header{min-height:16.43px;padding:15px;border-bottom:1px solid #e5e5e5}.modal-header .close{margin-top:-2px}.modal-title{margin:0;line-height:1.42857143}.modal-body{position:relative;padding:15px}.modal-footer{padding:15px;text-align:right;border-top:1px solid #e5e5e5}.modal-footer .btn+.btn{margin-bottom:0;margin-left:5px}.modal-footer .btn-group .btn+.btn{margin-left:-1px}.modal-footer .btn-block+.btn-block{margin-left:0}.modal-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}@media (min-width:768px){.modal-dialog{width:600px;margin:30px auto}.modal-content{-webkit-box-shadow:0 5px 15px rgba(0,0,0,.5);box-shadow:0 5px 15px rgba(0,0,0,.5)}.modal-sm{width:300px}}@media (min-width:992px){.modal-lg{width:900px}}.tooltip{position:absolute;z-index:1070;display:block;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:12px;font-weight:400;line-height:1.4;filter:alpha(opacity=0);opacity:0}.tooltip.in{filter:alpha(opacity=90);opacity:.9}.tooltip.top{padding:5px 0;margin-top:-3px}.tooltip.right{padding:0 5px;margin-left:3px}.tooltip.bottom{padding:5px 0;margin-top:3px}.tooltip.left{padding:0 5px;margin-left:-3px}.tooltip-inner{max-width:200px;padding:3px 8px;color:#fff;text-align:center;text-decoration:none;background-color:#000;border-radius:4px}.tooltip-arrow{position:absolute;width:0;height:0;border-color:transparent;border-style:solid}.tooltip.top .tooltip-arrow{bottom:0;left:50%;margin-left:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.top-left .tooltip-arrow{right:5px;bottom:0;margin-bottom:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.top-right .tooltip-arrow{bottom:0;left:5px;margin-bottom:-5px;border-width:5px 5px 0;border-top-color:#000}.tooltip.right .tooltip-arrow{top:50%;left:0;margin-top:-5px;border-width:5px 5px 5px 0;border-right-color:#000}.tooltip.left .tooltip-arrow{top:50%;right:0;margin-top:-5px;border-width:5px 0 5px 5px;border-left-color:#000}.tooltip.bottom .tooltip-arrow{top:0;left:50%;margin-left:-5px;border-width:0 5px 5px;border-bottom-color:#000}.tooltip.bottom-left .tooltip-arrow{top:0;right:5px;margin-top:-5px;border-width:0 5px 5px;border-bottom-color:#000}.tooltip.bottom-right .tooltip-arrow{top:0;left:5px;margin-top:-5px;border-width:0 5px 5px;border-bottom-color:#000}.popover{position:absolute;top:0;left:0;z-index:1060;display:none;max-width:276px;padding:1px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;font-weight:400;line-height:1.42857143;text-align:left;white-space:normal;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #ccc;border:1px solid rgba(0,0,0,.2);border-radius:6px;-webkit-box-shadow:0 5px 10px rgba(0,0,0,.2);box-shadow:0 5px 10px rgba(0,0,0,.2)}.popover.top{margin-top:-10px}.popover.right{margin-left:10px}.popover.bottom{margin-top:10px}.popover.left{margin-left:-10px}.popover-title{padding:8px 14px;margin:0;font-size:14px;background-color:#f7f7f7;border-bottom:1px solid #ebebeb;border-radius:5px 5px 0 0}.popover-content{padding:9px 14px}.popover>.arrow,.popover>.arrow:after{position:absolute;display:block;width:0;height:0;border-color:transparent;border-style:solid}.popover>.arrow{border-width:11px}.popover>.arrow:after{content:"";border-width:10px}.popover.top>.arrow{bottom:-11px;left:50%;margin-left:-11px;border-top-color:#999;border-top-color:rgba(0,0,0,.25);border-bottom-width:0}.popover.top>.arrow:after{bottom:1px;margin-left:-10px;content:" ";border-top-color:#fff;border-bottom-width:0}.popover.right>.arrow{top:50%;left:-11px;margin-top:-11px;border-right-color:#999;border-right-color:rgba(0,0,0,.25);border-left-width:0}.popover.right>.arrow:after{bottom:-10px;left:1px;content:" ";border-right-color:#fff;border-left-width:0}.popover.bottom>.arrow{top:-11px;left:50%;margin-left:-11px;border-top-width:0;border-bottom-color:#999;border-bottom-color:rgba(0,0,0,.25)}.popover.bottom>.arrow:after{top:1px;margin-left:-10px;content:" ";border-top-width:0;border-bottom-color:#fff}.popover.left>.arrow{top:50%;right:-11px;margin-top:-11px;border-right-width:0;border-left-color:#999;border-left-color:rgba(0,0,0,.25)}.popover.left>.arrow:after{right:1px;bottom:-10px;content:" ";border-right-width:0;border-left-color:#fff}.carousel{position:relative}.carousel-inner{position:relative;width:100%;overflow:hidden}.carousel-inner>.item{position:relative;display:none;-webkit-transition:.6s ease-in-out left;-o-transition:.6s ease-in-out left;transition:.6s ease-in-out left}.carousel-inner>.item>a>img,.carousel-inner>.item>img{line-height:1}@media all and (transform-3d),(-webkit-transform-3d){.carousel-inner>.item{-webkit-transition:-webkit-transform .6s ease-in-out;-o-transition:-o-transform .6s ease-in-out;transition:transform .6s ease-in-out;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:1000;perspective:1000}.carousel-inner>.item.active.right,.carousel-inner>.item.next{left:0;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}.carousel-inner>.item.active.left,.carousel-inner>.item.prev{left:0;-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.carousel-inner>.item.active,.carousel-inner>.item.next.left,.carousel-inner>.item.prev.right{left:0;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}}.carousel-inner>.active,.carousel-inner>.next,.carousel-inner>.prev{display:block}.carousel-inner>.active{left:0}.carousel-inner>.next,.carousel-inner>.prev{position:absolute;top:0;width:100%}.carousel-inner>.next{left:100%}.carousel-inner>.prev{left:-100%}.carousel-inner>.next.left,.carousel-inner>.prev.right{left:0}.carousel-inner>.active.left{left:-100%}.carousel-inner>.active.right{left:100%}.carousel-control{position:absolute;top:0;bottom:0;left:0;width:15%;font-size:20px;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,.6);filter:alpha(opacity=50);opacity:.5}.carousel-control.left{background-image:-webkit-linear-gradient(left,rgba(0,0,0,.5) 0,rgba(0,0,0,.0001) 100%);background-image:-o-linear-gradient(left,rgba(0,0,0,.5) 0,rgba(0,0,0,.0001) 100%);background-image:-webkit-gradient(linear,left top,right top,from(rgba(0,0,0,.5)),to(rgba(0,0,0,.0001)));background-image:linear-gradient(to right,rgba(0,0,0,.5) 0,rgba(0,0,0,.0001) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);background-repeat:repeat-x}.carousel-control.right{right:0;left:auto;background-image:-webkit-linear-gradient(left,rgba(0,0,0,.0001) 0,rgba(0,0,0,.5) 100%);background-image:-o-linear-gradient(left,rgba(0,0,0,.0001) 0,rgba(0,0,0,.5) 100%);background-image:-webkit-gradient(linear,left top,right top,from(rgba(0,0,0,.0001)),to(rgba(0,0,0,.5)));background-image:linear-gradient(to right,rgba(0,0,0,.0001) 0,rgba(0,0,0,.5) 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);background-repeat:repeat-x}.carousel-control:focus,.carousel-control:hover{color:#fff;text-decoration:none;filter:alpha(opacity=90);outline:0;opacity:.9}.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next,.carousel-control .icon-prev{position:absolute;top:50%;z-index:5;display:inline-block}.carousel-control .glyphicon-chevron-left,.carousel-control .icon-prev{left:50%;margin-left:-10px}.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next{right:50%;margin-right:-10px}.carousel-control .icon-next,.carousel-control .icon-prev{width:20px;height:20px;margin-top:-10px;font-family:serif;line-height:1}.carousel-control .icon-prev:before{content:'\2039'}.carousel-control .icon-next:before{content:'\203a'}.carousel-indicators{position:absolute;bottom:10px;left:50%;z-index:15;width:60%;padding-left:0;margin-left:-30%;text-align:center;list-style:none}.carousel-indicators li{display:inline-block;width:10px;height:10px;margin:1px;text-indent:-999px;cursor:pointer;background-color:#000 \9;background-color:rgba(0,0,0,0);border:1px solid #fff;border-radius:10px}.carousel-indicators .active{width:12px;height:12px;margin:0;background-color:#fff}.carousel-caption{position:absolute;right:15%;bottom:20px;left:15%;z-index:10;padding-top:20px;padding-bottom:20px;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,.6)}.carousel-caption .btn{text-shadow:none}@media screen and (min-width:768px){.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next,.carousel-control .icon-prev{width:30px;height:30px;margin-top:-15px;font-size:30px}.carousel-control .glyphicon-chevron-left,.carousel-control .icon-prev{margin-left:-15px}.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next{margin-right:-15px}.carousel-caption{right:20%;left:20%;padding-bottom:30px}.carousel-indicators{bottom:20px}}.btn-group-vertical>.btn-group:after,.btn-group-vertical>.btn-group:before,.btn-toolbar:after,.btn-toolbar:before,.clearfix:after,.clearfix:before,.container-fluid:after,.container-fluid:before,.container:after,.container:before,.dl-horizontal dd:after,.dl-horizontal dd:before,.form-horizontal .form-group:after,.form-horizontal .form-group:before,.modal-footer:after,.modal-footer:before,.nav:after,.nav:before,.navbar-collapse:after,.navbar-collapse:before,.navbar-header:after,.navbar-header:before,.navbar:after,.navbar:before,.pager:after,.pager:before,.panel-body:after,.panel-body:before,.row:after,.row:before{display:table;content:" "}.btn-group-vertical>.btn-group:after,.btn-toolbar:after,.clearfix:after,.container-fluid:after,.container:after,.dl-horizontal dd:after,.form-horizontal .form-group:after,.modal-footer:after,.nav:after,.navbar-collapse:after,.navbar-header:after,.navbar:after,.pager:after,.panel-body:after,.row:after{clear:both}.center-block{display:block;margin-right:auto;margin-left:auto}.pull-right{float:right!important}.pull-left{float:left!important}.hide{display:none!important}.show{display:block!important}.invisible{visibility:hidden}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.hidden{display:none!important}.affix{position:fixed}@-ms-viewport{width:device-width}.visible-lg,.visible-md,.visible-sm,.visible-xs{display:none!important}.visible-lg-block,.visible-lg-inline,.visible-lg-inline-block,.visible-md-block,.visible-md-inline,.visible-md-inline-block,.visible-sm-block,.visible-sm-inline,.visible-sm-inline-block,.visible-xs-block,.visible-xs-inline,.visible-xs-inline-block{display:none!important}@media (max-width:767px){.visible-xs{display:block!important}table.visible-xs{display:table}tr.visible-xs{display:table-row!important}td.visible-xs,th.visible-xs{display:table-cell!important}}@media (max-width:767px){.visible-xs-block{display:block!important}}@media (max-width:767px){.visible-xs-inline{display:inline!important}}@media (max-width:767px){.visible-xs-inline-block{display:inline-block!important}}@media (min-width:768px)and (max-width:991px){.visible-sm{display:block!important}table.visible-sm{display:table}tr.visible-sm{display:table-row!important}td.visible-sm,th.visible-sm{display:table-cell!important}}@media (min-width:768px)and (max-width:991px){.visible-sm-block{display:block!important}}@media (min-width:768px)and (max-width:991px){.visible-sm-inline{display:inline!important}}@media (min-width:768px)and (max-width:991px){.visible-sm-inline-block{display:inline-block!important}}@media (min-width:992px)and (max-width:1199px){.visible-md{display:block!important}table.visible-md{display:table}tr.visible-md{display:table-row!important}td.visible-md,th.visible-md{display:table-cell!important}}@media (min-width:992px)and (max-width:1199px){.visible-md-block{display:block!important}}@media (min-width:992px)and (max-width:1199px){.visible-md-inline{display:inline!important}}@media (min-width:992px)and (max-width:1199px){.visible-md-inline-block{display:inline-block!important}}@media (min-width:1200px){.visible-lg{display:block!important}table.visible-lg{display:table}tr.visible-lg{display:table-row!important}td.visible-lg,th.visible-lg{display:table-cell!important}}@media (min-width:1200px){.visible-lg-block{display:block!important}}@media (min-width:1200px){.visible-lg-inline{display:inline!important}}@media (min-width:1200px){.visible-lg-inline-block{display:inline-block!important}}@media (max-width:767px){.hidden-xs{display:none!important}}@media (min-width:768px)and (max-width:991px){.hidden-sm{display:none!important}}@media (min-width:992px)and (max-width:1199px){.hidden-md{display:none!important}}@media (min-width:1200px){.hidden-lg{display:none!important}}.visible-print{display:none!important}@media print{.visible-print{display:block!important}table.visible-print{display:table}tr.visible-print{display:table-row!important}td.visible-print,th.visible-print{display:table-cell!important}}.visible-print-block{display:none!important}@media print{.visible-print-block{display:block!important}}.visible-print-inline{display:none!important}@media print{.visible-print-inline{display:inline!important}}.visible-print-inline-block{display:none!important}@media print{.visible-print-inline-block{display:inline-block!important}}@media print{.hidden-print{display:none!important}}</style>
<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #F00 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #04D } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #00F; font-weight: bold } /* Name.Class */
.highlight .no { color: #800 } /* Name.Constant */
.highlight .nd { color: #A2F } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #00F } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.highlight .w { color: #BBB } /* Text.Whitespace */
.highlight .mb { color: #666 } /* Literal.Number.Bin */
.highlight .mf { color: #666 } /* Literal.Number.Float */
.highlight .mh { color: #666 } /* Literal.Number.Hex */
.highlight .mi { color: #666 } /* Literal.Number.Integer */
.highlight .mo { color: #666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #00F } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666 } /* Literal.Number.Integer.Long */
    </style>
<!-- Loading mathjax macro -->
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                messageStyle: 'none',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
<!-- End of mathjax configuration -->
<style>
td.center, th.center {
    text-align: center;
}

body {
  overflow: visible;
  font-size: 14px;
  padding-top: 1em;
}

div#notebook {
  overflow: visible;
  border-top: none;
}

div#notebook-container {
  width: 100%;
}

@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  }
  div.output_wrapper {
    display: block;
    page-break-inside: avoid;
  }
  div.output {
    display: block;
    page-break-inside: avoid;
  }
}

div.prompt {
  min-width: 21ex;
}

div.nbgrader_cell {
    width: 100%;
}

div.nbgrader_cell .panel-heading {
    padding: 0.4em 0.6em;
    height: 37px;
}

div.nbgrader_cell .panel-heading a {
    color: #BBBBBB;
}

div.nbgrader_cell .panel-footer {
    padding: 0.4em 0.6em;
}

div.nbgrader_cell .panel-body {
    padding: 0.4em;
}

.comment {
    width: 100%;
    margin-top: 0.5em;
}

div.nbgrader_cell .input_area {
    background: white;
    border: none;
}

.score {
    color: black;
}

li.late-penalty {
    color: #d2413a;
}

span.nbgrader-label {
    line-height: 25px;
}

.save-icon {
    margin-left: 1em;
    top: 4px;
}
</style>
</head>
<body>
<a name="top"></a>
<div class="container">
<div class="panel panel-default">
<div class="panel-heading">
<h4>ex06_deep-q-learning (Score: 10.0 / 10.0)</h4>
<div id="toc">
<ol>
<li><a href="#cell-02f08792391930df">Test cell</a> (Score: 1.0 / 1.0)</li>
<li><a href="#cell-6638146a1a48950b">Test cell</a> (Score: 1.0 / 1.0)</li>
<li><a href="#cell-cb441f633638dff8">Test cell</a> (Score: 1.0 / 1.0)</li>
<li><a href="#cell-55874102f12eeb67">Test cell</a> (Score: 2.0 / 2.0)</li>
<li><a href="#cell-38fb10ebd1e39242">Test cell</a> (Score: 5.0 / 5.0)</li>
</ol>
</div>
</div>
<div class="panel-body">
<div class="border-box-sizing" id="notebook">
<div class="container" id="notebook-container">
<body>
<main>
<div class="border-box-sizing" id="notebook" tabindex="-1">
<div class="container" id="notebook-container">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Deep-Q-Learning">Deep Q Learning<a class="anchor-link" href="#Deep-Q-Learning"></a></h1><p>In this exercise we will build a deep Q-learning agent from scratch. For this we need to look at the following tasks:</p>
<ul>
<li>How do we specify the model?</li>
<li>How do we calculate an action?</li>
<li>How do we sample episodes?</li>
<li>How do we train the model?</li>
</ul>
<p>We will develop this by implementing a class for the agent. We will use a package called jdc, that will allow us to split the implementation of a class over several cells.</p>
<p>We will be using torch for the implementation of the neural network and the training.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=18836b84-bfcc-4d2e-a25c-cd1d9dbef9f1">
<div class="input">
<div class="prompt input_prompt">In[1]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>jdc
<span class="kn">import</span><span class="w"> </span><span class="nn">jdc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gymnasium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gym</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.optim</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">optim</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyglet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: jdc in /opt/conda/lib/python3.12/site-packages (0.0.9)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-Cart-Pole">Example: Cart Pole<a class="anchor-link" href="#Example:-Cart-Pole"></a></h2><p>We will use an environment from OpenAI for this exercise. The goal is to balance a pole by moving the attached cart to the left or to the right. As the pole should be balanced as long as possible, the reward for each time step is +1. An episode is done when the angle of the pole becomes too large.</p>
<p>The observation space gives some measurements about the pole, for example the angle. However, we actually do not need to know the specific details, as the neural network will just learn using the input.</p>
<p>The actions are to move the cart to the left or to the right.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=db6fccfa-3da9-4939-a71e-f1ae82ceb64e">
<div class="input">
<div class="prompt input_prompt">In[2]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">environment_name</span> <span class="o">=</span> <span class="s1">'CartPole-v1'</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">environment_name</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s1">'rgb_array'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Observation space: </span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Action space: </span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Sample from the observation space: </span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
Action space: Discrete(2)
Sample from the observation space: [-3.6547575   0.07078268 -0.07106339  1.0597091 ]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The environment has a render function that we can use to display the state. The parameter 'render_mode' is used to specify the mode. For standalone applications, we can use 'human' that will open a window. Here we get the image as an array and display it using matplotlib.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=20961d56-4fe5-45d4-b67b-b791cb864706">
<div class="input">
<div class="prompt input_prompt">In[3]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>error: XDG_RUNTIME_DIR is invalid or not set in the environment.
ALSA lib confmisc.c:855:(parse_card) cannot find card '0'
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_card_inum returned error: No such file or directory
ALSA lib confmisc.c:422:(snd_func_concat) error evaluating strings
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_concat returned error: No such file or directory
ALSA lib confmisc.c:1342:(snd_func_refer) error evaluating name
ALSA lib conf.c:5204:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5727:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2721:(snd_pcm_open_noupdate) Unknown PCM default
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,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"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also try to render a sequence of images. Depending on your browser the display might not be optimal...</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=780d4e76-70ea-45b4-9b90-205cf6dbeb5c">
<div class="input">
<div class="prompt input_prompt">In[4]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">display_environment</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span> 
    <span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
    <span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Test the function with a few steps</span>
<span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>  <span class="c1"># Take a random action</span>
    <span class="n">display_environment</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,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"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Build-the-model">Build the model<a class="anchor-link" href="#Build-the-model"></a></h2><p>Our agent will use the class of the neural network (the model) as parameter, so that we can call it using different models. The first task is to write a example class that for the neural network. We will pass the number of observation values and the number of actions values as parameters.</p>
<p>The model must calculate the q function for each state. We will also need to access those values for evaluation where we do not need the gradient calculation.</p>
<p>Build a sequential model using at least two dense layers.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=afc9c401-f28d-4ed5-bfde-5990b8f3de02">
<div class="input">
<div class="prompt input_prompt">In[5]:</div><div class="panel panel-primary nbgrader_cell">
<a name="comment-cell-5f57f2a0435bd064"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DQNetwork</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_obs</span><span class="p">,</span> <span class="n">n_action</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DQNetwork</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># generate a sequential model in a internal variable (for example self.fc)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">n_obs</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span>      <span class="c1"># First hidden layer with 128 neurons</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>                   <span class="c1"># Activation function</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span>         <span class="c1"># Second hidden layer with 128 neurons</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>                   <span class="c1"># Activation function</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">n_action</span><span class="p">)</span>     <span class="c1"># Output layer (Q-values for each action)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_tensor</span><span class="p">):</span>
        <span class="c1"># forward should just call your model</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x_tensor</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">q_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_tensor</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs_tensor</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">q</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=9787f0e3-966e-4d85-94f8-e3950d45f90a">
<div class="input">
<div class="prompt input_prompt">In[6]:</div><div class="panel panel-primary nbgrader_cell">
<a name="cell-02f08792391930df"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-02f08792391930df</code></span>
<span class="pull-right">
      Score: 1.0 / 1.0 <a href="#top">(Top)</a>
</span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">DQNetwork</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">obs_sample</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>

<span class="c1"># models expect a batch of data, so we have to add a dimension and convert it to a tensor</span>
<span class="n">obs_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">obs_sample</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">obs_batch_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs_batch</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="n">action_values</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">q_values</span><span class="p">(</span><span class="n">obs_batch_tensor</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">action_values</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>DQNetwork(
  (fc): Sequential(
    (0): Linear(in_features=4, out_features=128, bias=True)
    (1): ReLU()
    (2): Linear(in_features=128, out_features=128, bias=True)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=2, bias=True)
  )
)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Device-managment-in-torch">Device managment in torch<a class="anchor-link" href="#Device-managment-in-torch"></a></h3><p>In order to use the gpu, we have to move our models to the device. We will also set this as
default device, so that any tensors will be initialized on it and we don't have to specify them every time.</p>
<p>In the code, we will use _tensor whenever a variable is a torch tensor.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=91ab168b-042e-403a-8e32-e5d2e98e721e">
<div class="input">
<div class="prompt input_prompt">In[7]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_device</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">'cuda'</span><span class="p">)</span>
        <span class="c1"># test if it worked</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Using CUDA device'</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">'mps'</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Using MPS device'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Using CPU'</span><span class="p">)</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">'cpu'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">device</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=ef3cfd11-13eb-4fd3-a850-e3a0262446aa">
<div class="input">
<div class="prompt input_prompt">In[8]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">get_device</span><span class="p">()</span>
<span class="n">torch</span><span class="o">.</span><span class="n">set_default_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Using CUDA device
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Agent-class">Agent class<a class="anchor-link" href="#Agent-class"></a></h2><p>Now we are ready to implement the agent class. Check the parameters and their descriptions as they will be used in the implementation and you will have to find suitable hyperparameters for them.</p>
<p>The only thing to fill out here are the optimizer and the loss function.</p>
<p>There are different optimizers available, either standand SGD or Adam would be possible and should be initialized with the learning rate given in the parameters.</p>
<p>What is the loss function that we have to use?</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=11fc0213-5dc9-4f23-ab2d-1d44d983a144">
<div class="input">
<div class="prompt input_prompt">In[9]:</div><div class="panel panel-primary nbgrader_cell">
<a name="comment-cell-8c19c66d131c3fbd"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DQNAgent</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                 <span class="n">observation_space</span><span class="p">,</span> 
                 <span class="n">action_space</span><span class="p">,</span>
                 <span class="n">model_cls</span><span class="p">,</span>
                 <span class="n">device</span><span class="p">,</span>
                 <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                 <span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">epsilon_decay</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">epsilon_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                 <span class="n">learning_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">training_frequency</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">target_update_frequency</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">tau</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">use_double_dqn</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                 <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">memory_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initialise the agent.</span>
<span class="sd">        Args:</span>
<span class="sd">            observation_space: The observation space of the environment</span>
<span class="sd">            action_space: The action space of the environment</span>
<span class="sd">            model_cls: the class that implements the model,</span>
<span class="sd">            device: the device to run torch on</span>
<span class="sd">            gamma: The discount factor</span>
<span class="sd">            epsilon: The initial epsilon value for the epsilon-greedy policy</span>
<span class="sd">            epsilon_decay: The decay factor for the epsilon value</span>
<span class="sd">            epsilon_min: The minimal epsilon value after which it will not be decayed further</span>
<span class="sd">            learning_rate: The learning rate for the optimizer</span>
<span class="sd">            training_frequency: The frequency (in steps) of training the model</span>
<span class="sd">            target_update_frequency: The frequency (in steps) of updating the target model (if not using tau)</span>
<span class="sd">            tau: weight of the new model in the target update </span>
<span class="sd">            use_double_dqn: use double q learning</span>
<span class="sd">            batch_size: The batch size for training (sampled from the memory)</span>
<span class="sd">            memory_size: The size of the memory for storing experiences</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">observation_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">action_space</span>
    
        <span class="c1"># hyperparameters from parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_decay</span> <span class="o">=</span> <span class="n">epsilon_decay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_min</span> <span class="o">=</span> <span class="n">epsilon_min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">memory_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">training_frequency</span> <span class="o">=</span> <span class="n">training_frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_update_frequency</span> <span class="o">=</span> <span class="n">target_update_frequency</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">use_double_dqn</span> <span class="o">=</span> <span class="n">use_double_dqn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">tau</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nr_training_steps</span> <span class="o">=</span> <span class="mi">0</span>
    
        <span class="c1"># internal variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nr_steps</span> <span class="o">=</span> <span class="mi">0</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">last_action</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_obs</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
    
        <span class="c1"># build the models</span>
        <span class="c1"># self.model = DQNetwork(observation_space.shape[0], action_space.n)</span>
        <span class="c1"># self.target_model = DQNetwork(observation_space.shape[0], action_space.n)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model_cls</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_model</span> <span class="o">=</span> <span class="n">model_cls</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Reset the agent to the initial state</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nr_steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_action</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_obs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nr_training_steps</span> <span class="o">=</span> <span class="mi">0</span>
    
    
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=a4cf988c-24c5-4b8e-ad91-e79fec78d7b4">
<div class="input">
<div class="prompt input_prompt">In[10]:</div><div class="panel panel-primary nbgrader_cell">
<a name="cell-6638146a1a48950b"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-6638146a1a48950b</code></span>
<span class="pull-right">
      Score: 1.0 / 1.0 <a href="#top">(Top)</a>
</span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">q_agent</span> <span class="o">=</span> <span class="n">DQNAgent</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span>
                       <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
                       <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                       <span class="n">model_cls</span><span class="o">=</span><span class="n">DQNetwork</span><span class="p">,</span>
                       <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
                       <span class="n">epsilon_min</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                       <span class="n">epsilon_decay</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                       <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span>
                       <span class="n">training_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">target_update_frequency</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="n">tau</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                       <span class="n">use_double_dqn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                       <span class="n">memory_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Updating-of-the-target-model">Updating of the target model<a class="anchor-link" href="#Updating-of-the-target-model"></a></h3><p>It is important in Q-Learning that the model that is trained and the target model used to calculate the target functions are not the same. The target model should stay fixed for a while or change only slowly.</p>
<p>There are two different methods to update the model:</p>
<ul>
<li>Replace the target model every number of steps</li>
<li>Interpolate between the policy and the target model</li>
</ul>
<p>Implement the update to use the replacement when the parameter tau is equal to 0 and the interpolation (using tau) when tau is greater than 0. You should later experiment with both update functions.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=a7bcc187-fd5a-4689-ba07-f7e62d128f13">
<div class="input">
<div class="prompt input_prompt">In[11]:</div><div class="panel panel-primary nbgrader_cell">
<a name="comment-cell-a1cb418924b7cb27"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> DQNAgent

def update_target_model(self):
        """
        Update the target model with the weights from the current model. There are two possibilities for
        updating:
        - Replace the target model every number of steps
        - Interpolate between the policy and the target model

        In both cases the update_target_model method will be called every self.target_update_frequency 
        number of steps (not training steps). If the update is done by replacement, the value should be
        higher, if the update is done by interpolation it can be lower.
        """
        
        
        policy_net_state_dict = self.model.state_dict()

        if self.tau &gt; 0.0:
            # Soft update (interpolation)
            target_net_state_dict = self.target_model.state_dict()
            for key in policy_net_state_dict:
                target_net_state_dict[key] = (self.tau * policy_net_state_dict[key] + 
                                             (1 - self.tau) * target_net_state_dict[key])
            self.target_model.load_state_dict(target_net_state_dict)
        else:
            # Hard update (complete replacement)
            self.target_model.load_state_dict(policy_net_state_dict)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=fbda48da-2108-4a2e-83a8-957b81d59023">
<div class="input">
<div class="prompt input_prompt">In[12]:</div><div class="panel panel-primary nbgrader_cell">
<a name="cell-cb441f633638dff8"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-cb441f633638dff8</code></span>
<span class="pull-right">
      Score: 1.0 / 1.0 <a href="#top">(Top)</a>
</span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">q_agent</span> <span class="o">=</span> <span class="n">DQNAgent</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span>
                       <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
                       <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                       <span class="n">model_cls</span><span class="o">=</span><span class="n">DQNetwork</span><span class="p">,</span>
                       <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
                       <span class="n">epsilon_min</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                       <span class="n">epsilon_decay</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                       <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span>
                       <span class="n">training_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">target_update_frequency</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="n">tau</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                       <span class="n">use_double_dqn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                       <span class="n">memory_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">q_agent</span><span class="o">.</span><span class="n">update_target_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calculating-actions">Calculating actions<a class="anchor-link" href="#Calculating-actions"></a></h2><p>Calculating actions is done with an epsilon greedy policy. However, for evaluation it is often suitable to use the greedy policy instead. So we add a parameter <code>stochastic</code>, if it is True then the epsilon-greedy policy is used, if not, the greedy policy is used.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=808c4b3c-82ec-456a-beb4-f94a3bc1e7b3">
<div class="input">
<div class="prompt input_prompt">In[13]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> DQNAgent

def calculate_action(self, obs_tensor, stochastic: bool = True) -&gt; int:
    """
    Calculate the action for the given observation.
    Args:
        obs: the observation
        stochastic: whether to use a stochastic (epsilon greedy) policy or not
    Returns:
        the action
    """
    if not stochastic or np.random.rand() &gt; self.epsilon:
        # calculate greedy action
        with torch.no_grad():
            action_value = self.model.q_values(obs_tensor)
        return torch.argmax(action_value).numpy(force=True)
    else:
        # calculate random action
        return self.action_space.sample()
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=d490aa0b-73f6-4001-8ee5-0387ff91a8dc">
<div class="input">
<div class="prompt input_prompt">In[14]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">DQNAgent</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span>
                 <span class="n">model_cls</span><span class="o">=</span><span class="n">DQNetwork</span><span class="p">,</span>
                 <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
                 <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
                 <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                 <span class="n">epsilon_min</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                 <span class="n">epsilon_decay</span><span class="o">=</span><span class="mf">0.9999</span><span class="p">,</span>
                 <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span>
                 <span class="n">training_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">target_update_frequency</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">tau</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                 <span class="n">use_double_dqn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                 <span class="n">memory_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">obs_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">calculate_action</span><span class="p">(</span><span class="n">obs_tensor</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">calculate_action</span><span class="p">(</span><span class="n">obs_tensor</span><span class="p">,</span> <span class="n">stochastic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Add-the-steps">Add the steps<a class="anchor-link" href="#Add-the-steps"></a></h2><p>Next we will add the two step functions as in the previous implementations of an agent. The <code>step_first</code> method is called after the environment is reset and we do not have any rewards yet.</p>
<p>The <code>step</code> method is called for all other steps. In the step method we need to</p>
<ul>
<li>Save the current experience (S, A, R, S', done) in the memory.</li>
<li>Calculate the next action</li>
<li>Save action and observation for next step</li>
<li>train the model every couple of steps</li>
<li>update the target model every couple of steps</li>
</ul>
<p>You have to fill in the code for the first three items.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=922fa8c8-bc5d-4552-8709-91c6a8c9c421">
<div class="input">
<div class="prompt input_prompt">In[15]:</div><div class="panel panel-primary nbgrader_cell">
<a name="comment-cell-f11d5c8957197292"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> DQNAgent
def train_model(self):
    # the method must exist in the class, or an error occurs
    
    # we will reimplement this later, issue a warning if it is not
    self.nr_training_steps += 1
    print('train model not replaced')
    
def step_first(self, obs):
    """
    Calculate the action for the first step in the environment after a reset.
    Args:
        obs: The observation from the environment
    Returns:
        the action
    """
    self.last_obs = obs
    obs_tensor = torch.tensor(obs)
    self.last_action = self.calculate_action(obs_tensor)
    return self.last_action

def step(self, obs, reward: float, done: bool):

    # now we have a new state and reward from the last action and can add that to the buffer (memory)
    # you should then calculate the next action, for this we need a tensor which is created here as example
    obs_tensor = torch.tensor(obs)
    
    # 1. Save the current experience (S, A, R, S', done) in the memory
    self.memory.append((self.last_obs, self.last_action, reward, obs, done))
    
    # 2. Calculate the next action
    action = self.calculate_action(obs_tensor)
    
    # 3. Save action and observation for next step
    self.last_action = action
    self.last_obs = obs

    self.nr_steps += 1

    if self.nr_steps % self.training_frequency == 0:
        self.train_model()

    if self.nr_steps % self.target_update_frequency == 0:
        self.update_target_model()

    return self.last_action
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=679ad371-d595-4b86-9b6d-322f0d2c3434">
<div class="input">
<div class="prompt input_prompt">In[16]:</div><div class="panel panel-primary nbgrader_cell">
<a name="cell-55874102f12eeb67"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-55874102f12eeb67</code></span>
<span class="pull-right">
      Score: 2.0 / 2.0 <a href="#top">(Top)</a>
</span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">DQNAgent</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span>
                 <span class="n">model_cls</span><span class="o">=</span><span class="n">DQNetwork</span><span class="p">,</span>
                 <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
                 <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
                 <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                 <span class="n">epsilon_min</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                 <span class="n">epsilon_decay</span><span class="o">=</span><span class="mf">0.9999</span><span class="p">,</span>
                 <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span>
                 <span class="n">training_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">target_update_frequency</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">tau</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                 <span class="n">use_double_dqn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                 <span class="n">memory_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">step_first</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-the-model-function">Train the model function<a class="anchor-link" href="#Train-the-model-function"></a></h2><p>The last thing to do is now to train the model. For this we have to</p>
<ul>
<li>Sample from the memory to get a batch of observations, actions, rewards, next observations and dones</li>
<li>Calculate a better estimate for the q values of the current observation using q-learning</li>
<li>Fit the model to the updated values using gradient descend on the loss</li>
<li>Decay the epsilon value</li>
</ul>
<p>In torch, the gradient descend step has to be calculated in the code. Todo this:</p>
<ul>
<li>Calculate the model output</li>
<li>Calculate the loss function</li>
<li>Clear the gradient (using self.optimizer.zero_grad())</li>
<li>Calculate a backwards step (resulting in the gradient)</li>
<li>Apply the step in the optimizer</li>
</ul>
<p>Note that between calculating the model, and calculating the loss function, you will have to calculate the target function (using the target_model), as no gradients are required on the target model, this code should be within a <code>with torch.no_grad()</code> block.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=f3a5506a-0c18-4433-8b1d-529177bc2cf4">
<div class="input">
<div class="prompt input_prompt">In[17]:</div><div class="panel panel-primary nbgrader_cell">
<a name="comment-cell-fe51b24157ad1aa1"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> DQNAgent

def train_model(self):
    # not enough samples yet
    if len(self.memory) &lt; self.batch_size:
        return

    # 1. Sample a batch from memory
    batch = random.sample(self.memory, self.batch_size)
    
    # Unpack the batch into separate arrays
    states = np.array([experience[0] for experience in batch])
    actions = np.array([experience[1] for experience in batch])
    rewards = np.array([experience[2] for experience in batch])
    next_states = np.array([experience[3] for experience in batch])
    dones = np.array([experience[4] for experience in batch])
    
    # Convert to tensors
    states_tensor = torch.FloatTensor(states).to(self.device)
    actions_tensor = torch.LongTensor(actions).to(self.device)
    rewards_tensor = torch.FloatTensor(rewards).to(self.device)
    next_states_tensor = torch.FloatTensor(next_states).to(self.device)
    dones_tensor = torch.FloatTensor(dones).to(self.device)
    
    # 2. Calculate current Q values (model output)
    current_q_values = self.model(states_tensor)
    current_q_values = current_q_values.gather(1, actions_tensor.unsqueeze(1)).squeeze(1)
    
    # 3. Calculate target Q values (no gradients needed)
    with torch.no_grad():
        if self.use_double_dqn:
            # Double DQN: use policy network to select action, target network to evaluate
            next_actions = self.model(next_states_tensor).argmax(1)
            next_q_values = self.target_model(next_states_tensor).gather(1, next_actions.unsqueeze(1)).squeeze(1)
        else:
            # Standard DQN: use target network for both selection and evaluation
            next_q_values = self.target_model(next_states_tensor).max(1)[0]
        
        # Calculate target: r + gamma * max(Q(s', a')) * (1 - done)
        target_q_values = rewards_tensor + self.gamma * next_q_values * (1 - dones_tensor)
    
    # 4. Calculate loss
    loss = self.loss(current_q_values, target_q_values)
    
    # 5. Perform gradient descent
    self.optimizer.zero_grad()  # Clear gradients
    loss.backward()             # Calculate gradients
    self.optimizer.step()       # Update weights

    self.nr_training_steps += 1
    
    # reduce epsilon
    if self.epsilon &gt; self.epsilon_min:
        self.epsilon *= self.epsilon_decay
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=53e246cf-b487-4e93-acc9-1b18e3d1417e">
<div class="input">
<div class="prompt input_prompt">In[18]:</div><div class="panel panel-primary nbgrader_cell">
<a name="cell-38fb10ebd1e39242"></a><div class="panel-heading"><span class="nbgrader-label">Grade cell: <code>cell-38fb10ebd1e39242</code></span>
<span class="pull-right">
      Score: 5.0 / 5.0 <a href="#top">(Top)</a>
</span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Test with a small version of the agent</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">DQNAgent</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span>
                 <span class="n">model_cls</span><span class="o">=</span><span class="n">DQNetwork</span><span class="p">,</span>
                 <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
                       <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
                       <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                       <span class="n">epsilon_min</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                       <span class="n">epsilon_decay</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                       <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span>
                       <span class="n">training_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">target_update_frequency</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                       <span class="n">tau</span><span class="o">=</span><span class="mf">0.00</span><span class="p">,</span>
                       <span class="n">use_double_dqn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                       <span class="n">memory_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">obs</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">step_first</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">truncated</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">done</span> <span class="ow">or</span> <span class="n">truncated</span><span class="p">:</span>
        <span class="n">obs</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">step_first</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">agent</span><span class="o">.</span><span class="n">nr_training_steps</span> <span class="o">&gt;</span> <span class="mi">4</span>
    
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Congratulations! You have implemented a full DQN Agent.</p>
</div>
</div></div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Complete-agent-for-training-and-evaluation.">Complete agent for training and evaluation.<a class="anchor-link" href="#Complete-agent-for-training-and-evaluation."></a></h2><p>We will add some additional methods to the agent in order to train and evaluate it more easily.</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=14b25676-7364-48ef-9ebb-9ac55e730bd0">
<div class="input">
<div class="prompt input_prompt">In[19]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> DQNAgent

def train(self, env: gym.Env, nr_episodes_to_train: int,  eval_env: gym.Env, eval_frequency: int, reset_options={}):
    """
    Train the agent on the given environment for the given number of steps.
    Args:
        env: The environment on which to train the agent
        nr_episodes_to_train: the number of episodes to train
        eval_env: Environment for evaluation
        eval_frequency: Frequency of evaluation of the trained agent
    """
    nr_episodes = 0
    while True:
        obs, _ = env.reset(options=reset_options)
        a = self.step_first(obs)
        done = False
        truncated = False
        while not done and not truncated:
            obs, reward, done, truncated, _ = env.step(a)
            done = done or truncated
            a = self.step(obs, reward, done)

        nr_episodes += 1
        if nr_episodes % eval_frequency == 0:
            rewards = self.evaluate(eval_env, 10, reset_options=reset_options)
            print(f'Evaluation: episode {nr_episodes}, epsilon: {self.epsilon} mean reward: {np.mean(rewards)}')

        if nr_episodes &gt;= nr_episodes_to_train:
            return

def evaluate(self, env: gym.Env, nr_episodes: int, reset_options={}):
    """
    Evaluate the agent on the given environment for the given number of episodes.
    Args:
        env: the environment on which to evaluate the agent
        nr_episodes: the number of episodes to evaluate
    Returns:
        the rewards for the episodes
    """
    rewards = []
    for e in range(nr_episodes):
        obs, _ = env.reset(options=reset_options)
        obs_tensor = torch.from_numpy(obs).to(self.device)
        a = self.calculate_action(obs_tensor, stochastic=False)
        done = False
        truncated = False
        episode_reward = 0
        # some environments do not support truncated episodes, so we additionally check for a maximal number of steps
        while not done and not truncated:
            obs, reward, done, truncated, _ = env.step(a)
            obs_tensor = torch.from_numpy(obs).to(self.device)
            a = self.calculate_action(obs_tensor, stochastic=False)
            episode_reward += reward
        rewards.append(episode_reward)
    return rewards
            
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-Training">Example Training<a class="anchor-link" href="#Example-Training"></a></h2><p>Here is an example with some hyperparameters and a short training time (that will not be enough to actually train the full agent). You can adjust the parameters and see if you get good results. But for handing in the exercise, put it back to a short training :-).</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=732052e5-bc4f-40d4-a496-18babc377d97">
<div class="input">
<div class="prompt input_prompt">In[20]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">env_train</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">environment_name</span><span class="p">)</span>
<span class="n">env_eval</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">environment_name</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s1">'rgb_array'</span><span class="p">)</span>

 <span class="c1"># Hyperparameters will be quite important here.</span>
<span class="n">q_agent</span> <span class="o">=</span> <span class="n">DQNAgent</span><span class="p">(</span><span class="n">env_train</span><span class="o">.</span><span class="n">observation_space</span><span class="p">,</span> <span class="n">env_train</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span>
                   <span class="n">model_cls</span><span class="o">=</span><span class="n">DQNetwork</span><span class="p">,</span>
                   <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
                   <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
                   <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                   <span class="n">epsilon_min</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                   <span class="n">epsilon_decay</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span>
                   <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                   <span class="n">training_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">target_update_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">tau</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                   <span class="n">use_double_dqn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                   <span class="n">memory_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># the parameters are not optimal, but should already give a result</span>
<span class="n">q_agent</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">env_train</span><span class="p">,</span> <span class="n">nr_episodes_to_train</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">eval_env</span><span class="o">=</span><span class="n">env_eval</span><span class="p">,</span> <span class="n">eval_frequency</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluation: episode 50, epsilon: 0.16443982479522729 mean reward: 83.0
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluation: episode 100, epsilon: 0.02998489123020412 mean reward: 197.2
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluation: episode 150, epsilon: 0.02998489123020412 mean reward: 265.1
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluation: episode 200, epsilon: 0.02998489123020412 mean reward: 79.1
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluation: episode 250, epsilon: 0.02998489123020412 mean reward: 74.0
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[20], line 21</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> q_agent <span style="color: rgb(98,98,98)">=</span> DQNAgent(env_train<span style="color: rgb(98,98,98)">.</span>observation_space, env_train<span style="color: rgb(98,98,98)">.</span>action_space,
<span class="ansi-green-intense-fg ansi-bold">      6</span>                    model_cls<span style="color: rgb(98,98,98)">=</span>DQNetwork,
<span class="ansi-green-intense-fg ansi-bold">      7</span>                    device<span style="color: rgb(98,98,98)">=</span>device,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span>                    batch_size<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">256</span>,
<span class="ansi-green-intense-fg ansi-bold">     18</span>                    memory_size<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">10000</span>)
<span class="ansi-green-intense-fg ansi-bold">     20</span> <span style="color: rgb(95,135,135)"># the parameters are not optimal, but should already give a result</span>
<span class="ansi-green-fg">---&gt; 21</span> <span class="ansi-yellow-bg">q_agent</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">env_train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">nr_episodes_to_train</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1000</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">eval_env</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">env_eval</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">eval_frequency</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">50</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">&lt;string&gt;:19</span>, in <span class="ansi-cyan-fg">train</span><span class="ansi-blue-fg">(self, env, nr_episodes_to_train, eval_env, eval_frequency, reset_options)</span>

File <span class="ansi-green-fg">&lt;string&gt;:44</span>, in <span class="ansi-cyan-fg">step</span><span class="ansi-blue-fg">(self, obs, reward, done)</span>

File <span class="ansi-green-fg">&lt;string&gt;:45</span>, in <span class="ansi-cyan-fg">train_model</span><span class="ansi-blue-fg">(self)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/_tensor.py:617</span>, in <span class="ansi-cyan-fg">Tensor.backward</span><span class="ansi-blue-fg">(self, gradient, retain_graph, create_graph, inputs)</span>
<span class="ansi-green-intense-fg ansi-bold">    573</span> <span style="color: rgb(175,0,0)">r</span><span style="color: rgb(175,0,0)">"""Computes the gradient of current tensor wrt graph leaves.</span>
<span class="ansi-green-intense-fg ansi-bold">    574</span> 
<span class="ansi-green-intense-fg ansi-bold">    575</span> <span style="color: rgb(175,0,0)">The graph is differentiated using the chain rule. If the tensor is</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    614</span> <span style="color: rgb(175,0,0)">        used to compute the :attr:`tensors`.</span>
<span class="ansi-green-intense-fg ansi-bold">    615</span> <span style="color: rgb(175,0,0)">"""</span>
<span class="ansi-green-intense-fg ansi-bold">    616</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> has_torch_function_unary(<span style="color: rgb(0,135,0)">self</span>):
<span class="ansi-green-fg">--&gt; 617</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">handle_torch_function</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    618</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">Tensor</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">backward</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    619</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    620</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    621</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">gradient</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">gradient</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    622</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">retain_graph</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">retain_graph</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    623</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">create_graph</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">create_graph</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    624</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    625</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    626</span> torch<span style="color: rgb(98,98,98)">.</span>autograd<span style="color: rgb(98,98,98)">.</span>backward(
<span class="ansi-green-intense-fg ansi-bold">    627</span>     <span style="color: rgb(0,135,0)">self</span>, gradient, retain_graph, create_graph, inputs<span style="color: rgb(98,98,98)">=</span>inputs
<span class="ansi-green-intense-fg ansi-bold">    628</span> )

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/overrides.py:1720</span>, in <span class="ansi-cyan-fg">handle_torch_function</span><span class="ansi-blue-fg">(public_api, relevant_args, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1716</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> _is_torch_function_mode_enabled():
<span class="ansi-green-intense-fg ansi-bold">   1717</span>     <span style="color: rgb(95,135,135)"># if we're here, the mode must be set to a TorchFunctionStackMode</span>
<span class="ansi-green-intense-fg ansi-bold">   1718</span>     <span style="color: rgb(95,135,135)"># this unsets it and calls directly into TorchFunctionStackMode's torch function</span>
<span class="ansi-green-intense-fg ansi-bold">   1719</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> _pop_mode_temporarily() <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> mode:
<span class="ansi-green-fg">-&gt; 1720</span>         result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">mode</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">__torch_function__</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">public_api</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">types</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1721</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> result <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">NotImplemented</span>:
<span class="ansi-green-intense-fg ansi-bold">   1722</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> result

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/utils/_device.py:104</span>, in <span class="ansi-cyan-fg">DeviceContext.__torch_function__</span><span class="ansi-blue-fg">(self, func, types, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> func <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> _device_constructors() <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">device</span><span style="color: rgb(175,0,0)">'</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    103</span>     kwargs[<span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">device</span><span style="color: rgb(175,0,0)">'</span>] <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>device
<span class="ansi-green-fg">--&gt; 104</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/_tensor.py:626</span>, in <span class="ansi-cyan-fg">Tensor.backward</span><span class="ansi-blue-fg">(self, gradient, retain_graph, create_graph, inputs)</span>
<span class="ansi-green-intense-fg ansi-bold">    616</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> has_torch_function_unary(<span style="color: rgb(0,135,0)">self</span>):
<span class="ansi-green-intense-fg ansi-bold">    617</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> handle_torch_function(
<span class="ansi-green-intense-fg ansi-bold">    618</span>         Tensor<span style="color: rgb(98,98,98)">.</span>backward,
<span class="ansi-green-intense-fg ansi-bold">    619</span>         (<span style="color: rgb(0,135,0)">self</span>,),
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    624</span>         inputs<span style="color: rgb(98,98,98)">=</span>inputs,
<span class="ansi-green-intense-fg ansi-bold">    625</span>     )
<span class="ansi-green-fg">--&gt; 626</span> <span class="ansi-yellow-bg">torch</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">autograd</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">backward</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    627</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">gradient</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">retain_graph</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">create_graph</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">inputs</span>
<span class="ansi-green-intense-fg ansi-bold">    628</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/autograd/__init__.py:347</span>, in <span class="ansi-cyan-fg">backward</span><span class="ansi-blue-fg">(tensors, grad_tensors, retain_graph, create_graph, grad_variables, inputs)</span>
<span class="ansi-green-intense-fg ansi-bold">    342</span>     retain_graph <span style="color: rgb(98,98,98)">=</span> create_graph
<span class="ansi-green-intense-fg ansi-bold">    344</span> <span style="color: rgb(95,135,135)"># The reason we repeat the same comment below is that</span>
<span class="ansi-green-intense-fg ansi-bold">    345</span> <span style="color: rgb(95,135,135)"># some Python versions print out the first line of a multi-line function</span>
<span class="ansi-green-intense-fg ansi-bold">    346</span> <span style="color: rgb(95,135,135)"># calls in the traceback and some print out the last line</span>
<span class="ansi-green-fg">--&gt; 347</span> <span class="ansi-yellow-bg">_engine_run_backward</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    348</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">tensors</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    349</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">grad_tensors_</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    350</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">retain_graph</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    351</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">create_graph</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    352</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    353</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">allow_unreachable</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    354</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">accumulate_grad</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    355</span> <span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/autograd/graph.py:823</span>, in <span class="ansi-cyan-fg">_engine_run_backward</span><span class="ansi-blue-fg">(t_outputs, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    821</span>     unregister_hooks <span style="color: rgb(98,98,98)">=</span> _register_logging_hooks_on_whole_graph(t_outputs)
<span class="ansi-green-intense-fg ansi-bold">    822</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 823</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">Variable</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_execution_engine</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">run_backward</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">  </span><span class="ansi-yellow-bg" style="color: rgb(95,135,135)"># Calls into the C++ engine to run the backward pass</span>
<span class="ansi-green-intense-fg ansi-bold">    824</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">t_outputs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span>
<span class="ansi-green-intense-fg ansi-bold">    825</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>  <span style="color: rgb(95,135,135)"># Calls into the C++ engine to run the backward pass</span>
<span class="ansi-green-intense-fg ansi-bold">    826</span> <span class="ansi-bold" style="color: rgb(0,135,0)">finally</span>:
<span class="ansi-green-intense-fg ansi-bold">    827</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> attach_logging_hooks:

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">CellTimeoutError</span>: No reply from kernel before timeout</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=fe8b3c3b-1d54-4e5a-8a07-cef082a51899">
<div class="input">
<div class="prompt input_prompt">In[21]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">q_agent</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">env_eval</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[21]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>[96.0, 96.0, 46.0, 94.0, 94.0]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=fcb7ac82-ea78-4f37-bb3d-86cc843a1d03">
<div class="input">
<div class="prompt input_prompt">In[22]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Test the function with a few steps</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">environment_name</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s1">'rgb_array'</span><span class="p">)</span>
<span class="n">obs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">obs_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">q_agent</span><span class="o">.</span><span class="n">calculate_action</span><span class="p">(</span><span class="n">obs_tensor</span><span class="p">,</span> <span class="n">stochastic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>  <span class="c1"># Take a random action</span>
    <span class="n">obs_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">display_environment</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeEAAAFICAYAAABnWUYoAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjEsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvc2/+5QAAAAlwSFlzAAAPYQAAD2EBqD+naQAADYpJREFUeJzt3UuPXHV6wOH3VPW9jbvdbhsYX4AkhGG4mWQT5IlmJtsoGkVRFtnnE7DOJ8jHiJRNlE1Gw2I2E80kREEoYiZhuISLAGMb43a7L1RVd91OFiYRBFynB+zz2uc8z8pWv229i3b/VHVO/U9RlmUZAEDtOtkLAEBbiTAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0ASEQaAJCIMAElEGACSiDAAJBFhAEgiwgCQRIQBIIkIA0CSuewF4E4ryzKiLKMspxFlGVEU0en6UQfuPX4zcd8ryzImw0FMhv2YHA5iNNiN/tbH0b9xKXrXP4i188/E+Rf+MopON3tVgC8RYe5rZVnGJ7/+WQxuXo3D/RtxuHc9Rr2bX5oZ7m/FaLAfC6vrOUsC3IYIc9/75Fc/i/Fh77Zf37/6bgxuXhVh4J7jxizue3PLD8z8+mTYj8lwcOtaMcA9RIS5733nD/+scmbU3711kxbAPUSEue8tb5ypnBlsfxzldFzDNgBHJ8Lc14qiiO7cQuXcjXdeicl4WMNGAEcnwtz3iu5cLB4/NXNmOh7GVISBe4wIc9+bWzoWm9+9WDk32L5SwzYARyfC3PeKTjcWVtYq5678x09r2Abg6ESY+15RFNGZX47O/OLMuVF/p56FAI5IhGmE1VPnY/XUozNnynIa48N+PQsBHIEI0wjzK2sxX/GWdDkZx+Dm1Zo2AqgmwjRC0ZmLTnd+5sz44LPYevNfatoIoJoI0whFUcTS2oNRVIR4OhndesQhwD1AhGmM9ceej7mlYzNnJsNBTFwXBu4RIkxjLB0/VfmW9LB3Mw73t2vaCGA2EaYxik4nopg9M9i+HL2tD2rZB6CKCNMo6+efrZyZjkdRTl0XBvKJMI2y+d3vV84c7F6L6cQ50kA+EaZRFlbXK2eu/+YXMert3PVdAKqIMI1SdDqxfPJsxVQZZS3bAMwmwjRK0Z2PE48+Xzk36u1EWUoxkEuEaZSi6MTK5rnKub3Lb9WwDcBsIkyjFEURne5c5dynr/88wpvSQDIRpnHmV0/E8saZmTNlhI8pAelEmMZZOLYRK6cemT1UTuNg91o9CwHchgjTON35pVhYPj5zppxOYvfSb2raCODriTCNUxQVZ1fGrQjviTCQTIRppLVzT8fCsY2ZM+V0EpPRYU0bAXyVCNNIK5vnY27pgZkzw/5uDLav1LQRwFeJMI3UXViKotudOXO4ey32Lr9R00YAXyXCNNba2acijnJ92MlZQBIRprHWzj8TRTH7R3zU34vp2BOVgBwiTGMtn3i48pXwZ5++H6P+bk0bAXyZCNNYRWf2NeGIiP71D2PU36thG4CvEmEaq+h04tSTP6icK6cT14WBFCJMgxVx/MwTlVP9rY8iRBhIIMI0VlEUsbB6onJu+71XoywnNWwE8GUiTLMVRUTMvjmrt/WRJyoBKUSYRlt8YDM2n3ihcm40cHMWUD8RptG684uxePzU7KGyjK23/62ehQC+QIRptKLTjc7cQsVUGTsf/LqWfQC+SIRpvGMP/k4srT9YMVW6LgzUToRpvMUHTsX88trMmel4FMPedk0bAdwiwjTe3NKx6C4sz5wZ9Xdj58P/rGkjgFtEmMYrOp0ounMzZ6bjwzjY/bSmjQBuEWFa4fT3fhid+cWZM+VkHOXUoR1AfUSYVlg5eTaKzuxXw8PPbsZosF/TRgAiTEt0F1eiqHqs4SfvxGD7ck0bAYgwLTK/MvsO6cnoICbDA09UAmojwrTGd/7gTytnhv2diNLnhYF6iDCtsbxxpnJmsH05pm7OAmoiwrRCURRHOL4y4sY7/x7T0UENGwGIMC3S6c7F0vpDM2fKyTim42FNGwFtJ8K0RndxNTafuFg519++UsM2ACJMixSdbuUd0hERV179pxq2ARBhWqQoiuguLEd3fmnm3OjAgR1APUSYVlk5eTZWTj86e6gsY3zYr2UfoN1EmFaZX1mLhdUTM2emk5GTs4BaiDCtUnS6lWdITw77cf3NX9a0EdBmIkyrFEURyyceqvzM8HQyidLJWcBdJsK0zvojz8Xc0rGZM5PhIMYHrgsDd5cI0zqLD2xG0Z2fOTPq3Yzh/lZNGwFtJcK0TtHpxOyHGkYMbl6J3vUP6lgHaDERppXWH3u+cmY6HkU5dV0YuHtEmFba/P0XKmcGu9ecIw3cVSJMK82vrkdUvCm99eYvY9i7Wcs+QDuJMK1UFJ1Y2TyfvQbQciJMK3W6c3HisQuVc8PezSjL8u4vBLSSCNNORSdWTp6rHNv7+I0algHaSoRppaIooujOPr4yIuLTN34REV4JA3eHCNNaC6vrR3o17GNKwN0iwrTWwupGrJx6ZPZQWcbBzav1LAS0jgjTWp35xZhfPj5zZjoZx86l12vaCGgbEaa1iqLq8MqIKKduzgLuGhGm1dbOPx0LD2zOnCmnk5iMDmvaCGgTEabVVk6ei/mKxxqO+rvRv3Gppo2ANhFhWq07vxhFtztz5nDveuxdfrOmjYA2EWFab+3cMxFF9X8FJ2cBd5oI03pr556KoiLCo/5eTMeuCwN3lgjTeksnHo6ouFO6d+39GPZ26lkIaA0RpvU6nW7FQw0j+jcuxai/V8s+QHuIMBRFnH76TyrHysnYdWHgjipKv1VokNFoFC+99NJv9T1lWUbsXYqzB7NPxhqeuhDXOw9HVL5uvr0f/ehHsba29o2/H2gWEaZRdnZ2YmNj47d+xfr42Y34+7/5i5kzb320FX/9tz+J4Xjyjfd77bXX4sKFC9/4+4FmqX6WG7RAWUZMptPodjr/9/cyOlFGEf/7p8fPbkSn881fBQP8fyIMEXH1xn785OW348//+MmYlp24fPh4fDh4KnqT9Vjq7se5xbfizOKbcfL4clze2s9eF2gIN2ZBRAwOx3F5az/KMuL9wYV4/bMfxP5kM6YxF/3JiXi7/0L8d/+P4sff/172qkCDiDBExLQs42A4jvcGz8e7/ee/dubjwydj/bG/qnkzoMlEGD73X+9fi19d6kYZtztLuoid8YPROcojEAGOQIThc1dv7MeN3f7MmaX5uXhwY7WmjYCmE2H43G7vMHoHo5kzJ9eW44cXHq1nIaDxRBg+V5YRv7fwz7Hc2f3ar88XB3Fx8+dxZvN4zZsBTSXC8AU//dfX4tnFf4gTc1djrjiIW58RPow4+Cg2e38Xb7z7drx3ZTt7TaAhfE4YvuDdy9sxHfdio/+PcenKsXjv2ji2trdi3Hsvbtz4OD7Z/ix2ex5pCNwZRz628uLFi3d7F/jWJpNJvPLKK9/q3/jdMydiOJxE/3AUvYNRHAzHd2i7iOeeey5WV93YBW3w8ssvV84cOcLD4fBbLwR3287OTjz00EP37NOOXn311Xj22Wez1wBqsLCwUDlz5Lejj/KPQbZ7/ed0bm7unt8RqI8bswAgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQc40CiLi4vx4osvZq9xW6dPn85eAbiHHPnsaADgzvJ2NAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASCLCAJBEhAEgiQgDQBIRBoAkIgwASUQYAJKIMAAkEWEASPI/XdXTVDZZ7sEAAAAASUVORK5CYII="/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Bonus-Exercise">Bonus Exercise<a class="anchor-link" href="#Bonus-Exercise"></a></h1><p>Can you try training for another example, like the mountain car from the lecture?</p>
</div>
</div></div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=5f787162-82ef-4a51-8e8e-d488863dfa6a">
<div class="input">
<div class="prompt input_prompt">In[23]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">other_env</span> <span class="o">=</span> <span class="s1">'MountainCar-v0'</span>

<span class="n">env_train</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">other_env</span><span class="p">)</span>
<span class="n">env_eval</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">other_env</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s1">'rgb_array'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Observation space: </span><span class="si">{</span><span class="n">env_eval</span><span class="o">.</span><span class="n">observation_space</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Action space: </span><span class="si">{</span><span class="n">env_eval</span><span class="o">.</span><span class="n">action_space</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observation space: Box([-1.2  -0.07], [0.6  0.07], (2,), float32)
Action space: Discrete(3)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=9d8aaaaa-c62e-4169-9dbd-8d8bcc9b0350">
<div class="input">
<div class="prompt input_prompt">In[24]:</div><div class="panel panel-primary nbgrader_cell">
<a name="comment-cell-a4cde5d226be73e4"></a><div class="panel-heading"><span class="nbgrader-label">Student's answer</span><span class="pull-right"><a href="#top">(Top)</a></span></div>
<div class="panel-body">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create the agent for MountainCar</span>
<span class="n">q_agent</span> <span class="o">=</span> <span class="n">DQNAgent</span><span class="p">(</span>
    <span class="n">env_train</span><span class="o">.</span><span class="n">observation_space</span><span class="p">,</span> 
    <span class="n">env_train</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span>
    <span class="n">model_cls</span><span class="o">=</span><span class="n">DQNetwork</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
    <span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
    <span class="n">epsilon</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Start with high exploration</span>
    <span class="n">epsilon_min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">epsilon_decay</span><span class="o">=</span><span class="mf">0.995</span><span class="p">,</span>  <span class="c1"># Slower decay for MountainCar</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">training_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">target_update_frequency</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># Update target less frequently</span>
    <span class="n">tau</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Use hard updates</span>
    <span class="n">use_double_dqn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Double DQN helps with MountainCar</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">memory_size</span><span class="o">=</span><span class="mi">50000</span>
<span class="p">)</span>

<span class="c1"># Training parameters</span>
<span class="n">num_episodes</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">max_steps_per_episode</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">episode_rewards</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">episode</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_episodes</span><span class="p">)):</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_train</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">q_agent</span><span class="o">.</span><span class="n">step_first</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
    
    <span class="n">episode_reward</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_steps_per_episode</span><span class="p">):</span>
        <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">truncated</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env_train</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">q_agent</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
        
        <span class="n">episode_reward</span> <span class="o">+=</span> <span class="n">reward</span>
        
        <span class="k">if</span> <span class="n">done</span> <span class="ow">or</span> <span class="n">truncated</span><span class="p">:</span>
            <span class="k">break</span>
    
    <span class="n">episode_rewards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">episode_reward</span><span class="p">)</span>
    
    <span class="c1"># Print progress every 50 episodes</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">episode</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">avg_reward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">episode_rewards</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:])</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Episode </span><span class="si">{</span><span class="n">episode</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">, Avg Reward (last 50): </span><span class="si">{</span><span class="n">avg_reward</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Epsilon: </span><span class="si">{</span><span class="n">q_agent</span><span class="o">.</span><span class="n">epsilon</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Plot training progress</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">episode_rewards</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Episode'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Total Reward'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Training Progress'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">episode_rewards</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'valid'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Episode'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Average Reward (50 episodes)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Smoothed Training Progress'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|                                                                                                                  | 0/500 [00:00&lt;?, ?it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|                                                                                                         | 1/500 [00:00&lt;01:38,  5.07it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|                                                                                                         | 2/500 [00:00&lt;03:19,  2.50it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  1%|                                                                                                         | 3/500 [00:01&lt;03:57,  2.09it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  1%|                                                                                                         | 4/500 [00:01&lt;04:16,  1.94it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  1%|                                                                                                         | 5/500 [00:02&lt;04:26,  1.85it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  1%|                                                                                                        | 6/500 [00:03&lt;04:32,  1.81it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  1%|                                                                                                        | 7/500 [00:03&lt;04:32,  1.81it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  2%|                                                                                                        | 8/500 [00:04&lt;04:32,  1.81it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  2%|                                                                                                        | 9/500 [00:04&lt;04:31,  1.81it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  2%|                                                                                                       | 10/500 [00:05&lt;04:31,  1.81it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  2%|                                                                                                      | 11/500 [00:05&lt;04:31,  1.80it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  2%|                                                                                                      | 12/500 [00:06&lt;04:32,  1.79it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  3%|                                                                                                      | 13/500 [00:07&lt;04:41,  1.73it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  3%|                                                                                                      | 14/500 [00:07&lt;04:38,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  3%|                                                                                                     | 15/500 [00:08&lt;04:36,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  3%|                                                                                                     | 16/500 [00:08&lt;04:34,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  3%|                                                                                                     | 17/500 [00:09&lt;04:34,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  4%|                                                                                                     | 18/500 [00:09&lt;04:42,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  4%|                                                                                                     | 19/500 [00:10&lt;04:44,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  4%|                                                                                                    | 20/500 [00:11&lt;04:38,  1.72it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  4%|                                                                                                    | 21/500 [00:11&lt;04:35,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  4%|                                                                                                    | 22/500 [00:12&lt;04:34,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  5%|                                                                                                    | 23/500 [00:12&lt;04:33,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  5%|                                                                                                    | 24/500 [00:13&lt;04:31,  1.75it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  5%|                                                                                                   | 25/500 [00:13&lt;04:30,  1.75it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  5%|                                                                                                   | 26/500 [00:14&lt;04:29,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  5%|                                                                                                   | 27/500 [00:15&lt;04:27,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  6%|                                                                                                   | 28/500 [00:15&lt;04:26,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  6%|                                                                                                   | 29/500 [00:16&lt;04:25,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  6%|                                                                                                  | 30/500 [00:16&lt;04:26,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  6%|                                                                                                  | 31/500 [00:17&lt;04:27,  1.75it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  6%|                                                                                                  | 32/500 [00:17&lt;04:28,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  7%|                                                                                                  | 33/500 [00:18&lt;04:26,  1.75it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  7%|                                                                                                 | 34/500 [00:18&lt;04:22,  1.78it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  7%|                                                                                                 | 35/500 [00:19&lt;04:14,  1.83it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  7%|                                                                                                 | 36/500 [00:20&lt;04:16,  1.81it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  7%|                                                                                                 | 37/500 [00:20&lt;04:18,  1.79it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  8%|                                                                                                 | 38/500 [00:21&lt;04:13,  1.82it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  8%|                                                                                                | 39/500 [00:21&lt;04:16,  1.80it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  8%|                                                                                                | 40/500 [00:22&lt;04:19,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  8%|                                                                                                | 41/500 [00:22&lt;04:20,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  8%|                                                                                                | 42/500 [00:23&lt;04:18,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  9%|                                                                                                | 43/500 [00:24&lt;04:19,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  9%|                                                                                               | 44/500 [00:24&lt;04:18,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  9%|                                                                                               | 45/500 [00:25&lt;04:17,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  9%|                                                                                               | 46/500 [00:25&lt;04:13,  1.79it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>  9%|                                                                                               | 47/500 [00:26&lt;04:12,  1.79it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 10%|                                                                                               | 48/500 [00:26&lt;04:14,  1.78it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 10%|                                                                                              | 49/500 [00:27&lt;04:15,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 10%|                                                                                              | 50/500 [00:27&lt;04:14,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Episode 50, Avg Reward (last 50): -200.00, Epsilon: 0.010
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 10%|                                                                                              | 51/500 [00:28&lt;04:14,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 10%|                                                                                              | 52/500 [00:29&lt;04:15,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 11%|                                                                                             | 53/500 [00:29&lt;04:15,  1.75it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 11%|                                                                                             | 54/500 [00:30&lt;04:12,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 11%|                                                                                             | 55/500 [00:30&lt;04:11,  1.77it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 11%|                                                                                             | 56/500 [00:31&lt;04:11,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 11%|                                                                                             | 57/500 [00:31&lt;04:11,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 12%|                                                                                            | 58/500 [00:32&lt;04:11,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 12%|                                                                                            | 59/500 [00:33&lt;04:11,  1.75it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 12%|                                                                                            | 60/500 [00:33&lt;04:10,  1.75it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 12%|                                                                                            | 61/500 [00:34&lt;04:10,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 12%|                                                                                            | 62/500 [00:34&lt;04:10,  1.75it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 13%|                                                                                           | 63/500 [00:35&lt;04:10,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 13%|                                                                                           | 64/500 [00:35&lt;04:11,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 13%|                                                                                           | 65/500 [00:36&lt;04:11,  1.73it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 13%|                                                                                           | 66/500 [00:37&lt;04:10,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 13%|                                                                                           | 67/500 [00:37&lt;04:09,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|                                                                                          | 68/500 [00:38&lt;04:09,  1.73it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|                                                                                          | 69/500 [00:38&lt;04:08,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|                                                                                          | 70/500 [00:39&lt;04:08,  1.73it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|                                                                                          | 71/500 [00:40&lt;04:07,  1.73it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|                                                                                          | 72/500 [00:40&lt;04:07,  1.73it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 15%|                                                                                         | 73/500 [00:41&lt;04:07,  1.73it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 15%|                                                                                         | 74/500 [00:41&lt;04:09,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 15%|                                                                                         | 75/500 [00:42&lt;04:15,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 15%|                                                                                         | 76/500 [00:43&lt;04:22,  1.61it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 15%|                                                                                        | 77/500 [00:43&lt;04:22,  1.61it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 16%|                                                                                        | 78/500 [00:44&lt;04:18,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 16%|                                                                                        | 79/500 [00:44&lt;04:16,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 16%|                                                                                        | 80/500 [00:45&lt;04:12,  1.66it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 16%|                                                                                        | 81/500 [00:46&lt;04:10,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 16%|                                                                                       | 82/500 [00:46&lt;04:07,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 17%|                                                                                       | 83/500 [00:47&lt;04:05,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 17%|                                                                                       | 84/500 [00:47&lt;04:05,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 17%|                                                                                       | 85/500 [00:48&lt;04:05,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 17%|                                                                                       | 86/500 [00:48&lt;04:04,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 17%|                                                                                      | 87/500 [00:49&lt;04:03,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 18%|                                                                                      | 88/500 [00:50&lt;03:56,  1.74it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 18%|                                                                                      | 89/500 [00:50&lt;03:58,  1.72it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 18%|                                                                                      | 90/500 [00:51&lt;04:00,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 18%|                                                                                      | 91/500 [00:51&lt;04:00,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 18%|                                                                                     | 92/500 [00:52&lt;03:59,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 19%|                                                                                     | 93/500 [00:53&lt;03:59,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 19%|                                                                                     | 94/500 [00:53&lt;04:00,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 19%|                                                                                     | 95/500 [00:54&lt;03:59,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 19%|                                                                                    | 96/500 [00:54&lt;03:57,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 19%|                                                                                    | 97/500 [00:55&lt;03:56,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 20%|                                                                                    | 98/500 [00:55&lt;03:53,  1.72it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 20%|                                                                                    | 99/500 [00:56&lt;03:53,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 20%|                                                                                   | 100/500 [00:57&lt;03:54,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Episode 100, Avg Reward (last 50): -200.00, Epsilon: 0.010
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 20%|                                                                                   | 101/500 [00:57&lt;03:54,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 20%|                                                                                  | 102/500 [00:58&lt;03:53,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 21%|                                                                                  | 103/500 [00:58&lt;03:53,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 21%|                                                                                  | 104/500 [00:59&lt;03:52,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 21%|                                                                                  | 105/500 [01:00&lt;03:51,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 21%|                                                                                  | 106/500 [01:00&lt;03:51,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 21%|                                                                                 | 107/500 [01:01&lt;03:51,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 22%|                                                                                 | 108/500 [01:01&lt;03:50,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 22%|                                                                                 | 109/500 [01:02&lt;03:50,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 22%|                                                                                 | 110/500 [01:03&lt;03:48,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 22%|                                                                                 | 111/500 [01:03&lt;03:41,  1.76it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 22%|                                                                                | 112/500 [01:04&lt;03:46,  1.72it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 23%|                                                                                | 113/500 [01:04&lt;03:45,  1.72it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 23%|                                                                                | 114/500 [01:05&lt;03:45,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 23%|                                                                                | 115/500 [01:05&lt;03:44,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 23%|                                                                               | 116/500 [01:06&lt;03:45,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 23%|                                                                               | 117/500 [01:07&lt;03:46,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 24%|                                                                               | 118/500 [01:07&lt;03:45,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 24%|                                                                               | 119/500 [01:08&lt;03:45,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 24%|                                                                               | 120/500 [01:08&lt;03:44,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 24%|                                                                              | 121/500 [01:09&lt;03:42,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 24%|                                                                              | 122/500 [01:10&lt;03:42,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 25%|                                                                              | 123/500 [01:10&lt;03:41,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 25%|                                                                              | 124/500 [01:11&lt;03:41,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 25%|                                                                              | 125/500 [01:11&lt;03:40,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 25%|                                                                             | 126/500 [01:12&lt;03:40,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 25%|                                                                             | 127/500 [01:13&lt;03:39,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 26%|                                                                             | 128/500 [01:13&lt;03:38,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 26%|                                                                             | 129/500 [01:14&lt;03:38,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 26%|                                                                             | 130/500 [01:14&lt;03:39,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 26%|                                                                            | 131/500 [01:15&lt;03:38,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 26%|                                                                            | 132/500 [01:15&lt;03:38,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 27%|                                                                            | 133/500 [01:16&lt;03:37,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 27%|                                                                            | 134/500 [01:17&lt;03:36,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 27%|                                                                            | 135/500 [01:17&lt;03:35,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 27%|                                                                           | 136/500 [01:18&lt;03:35,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 27%|                                                                           | 137/500 [01:18&lt;03:34,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 28%|                                                                           | 138/500 [01:19&lt;03:33,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 28%|                                                                           | 139/500 [01:20&lt;03:34,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 28%|                                                                           | 140/500 [01:20&lt;03:36,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 28%|                                                                          | 141/500 [01:21&lt;03:41,  1.62it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 28%|                                                                          | 142/500 [01:22&lt;03:41,  1.62it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|                                                                          | 143/500 [01:22&lt;03:39,  1.62it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|                                                                          | 144/500 [01:23&lt;03:38,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|                                                                         | 145/500 [01:23&lt;03:36,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|                                                                         | 146/500 [01:24&lt;03:35,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|                                                                         | 147/500 [01:25&lt;03:35,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 30%|                                                                         | 148/500 [01:25&lt;03:36,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 30%|                                                                         | 149/500 [01:26&lt;03:35,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 30%|                                                                        | 150/500 [01:26&lt;03:33,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Episode 150, Avg Reward (last 50): -200.00, Epsilon: 0.010
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 30%|                                                                        | 151/500 [01:27&lt;03:33,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 30%|                                                                        | 152/500 [01:28&lt;03:32,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 31%|                                                                        | 153/500 [01:28&lt;03:32,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 31%|                                                                        | 154/500 [01:29&lt;03:27,  1.66it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 31%|                                                                       | 155/500 [01:29&lt;03:26,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 31%|                                                                       | 156/500 [01:30&lt;03:25,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 31%|                                                                       | 157/500 [01:31&lt;03:24,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 32%|                                                                       | 158/500 [01:31&lt;03:23,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 32%|                                                                       | 159/500 [01:32&lt;03:23,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 32%|                                                                      | 160/500 [01:32&lt;03:22,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 32%|                                                                      | 161/500 [01:33&lt;03:21,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 32%|                                                                      | 162/500 [01:34&lt;03:18,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 33%|                                                                      | 163/500 [01:34&lt;03:18,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 33%|                                                                      | 164/500 [01:35&lt;03:18,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 33%|                                                                     | 165/500 [01:35&lt;03:18,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 33%|                                                                     | 166/500 [01:36&lt;03:18,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 33%|                                                                     | 167/500 [01:37&lt;03:17,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 34%|                                                                     | 168/500 [01:37&lt;03:16,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 34%|                                                                    | 169/500 [01:38&lt;03:16,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 34%|                                                                    | 170/500 [01:38&lt;03:15,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 34%|                                                                    | 171/500 [01:39&lt;03:15,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 34%|                                                                    | 172/500 [01:39&lt;03:15,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 35%|                                                                    | 173/500 [01:40&lt;03:15,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 35%|                                                                   | 174/500 [01:41&lt;03:13,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 35%|                                                                   | 175/500 [01:41&lt;03:11,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 35%|                                                                   | 176/500 [01:42&lt;03:09,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 35%|                                                                   | 177/500 [01:42&lt;03:07,  1.72it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 36%|                                                                   | 178/500 [01:43&lt;03:08,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 36%|                                                                  | 179/500 [01:44&lt;03:09,  1.70it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 36%|                                                                  | 180/500 [01:44&lt;03:09,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 36%|                                                                  | 181/500 [01:45&lt;03:08,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 36%|                                                                  | 182/500 [01:45&lt;03:09,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 37%|                                                                  | 183/500 [01:46&lt;03:08,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 37%|                                                                 | 184/500 [01:47&lt;03:08,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 37%|                                                                 | 185/500 [01:47&lt;03:07,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 37%|                                                                 | 186/500 [01:48&lt;03:07,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 37%|                                                                 | 187/500 [01:48&lt;03:05,  1.69it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 38%|                                                                 | 188/500 [01:49&lt;03:05,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 38%|                                                                | 189/500 [01:50&lt;03:05,  1.68it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 38%|                                                                | 190/500 [01:50&lt;03:05,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 38%|                                                                | 191/500 [01:51&lt;03:05,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 38%|                                                                | 192/500 [01:51&lt;03:05,  1.66it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 39%|                                                               | 193/500 [01:52&lt;03:03,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 39%|                                                               | 194/500 [01:53&lt;03:03,  1.67it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 39%|                                                               | 195/500 [01:53&lt;03:05,  1.65it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 39%|                                                               | 196/500 [01:54&lt;03:05,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 39%|                                                               | 197/500 [01:54&lt;03:04,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 40%|                                                              | 198/500 [01:55&lt;03:04,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 40%|                                                              | 199/500 [01:56&lt;03:03,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 40%|                                                              | 200/500 [01:56&lt;03:04,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Episode 200, Avg Reward (last 50): -200.00, Epsilon: 0.010
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 40%|                                                              | 201/500 [01:57&lt;03:04,  1.62it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 40%|                                                              | 202/500 [01:57&lt;03:02,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 41%|                                                             | 203/500 [01:58&lt;03:01,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 41%|                                                             | 204/500 [01:59&lt;03:01,  1.63it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 41%|                                                             | 205/500 [01:59&lt;03:00,  1.64it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre> 41%|                                                             | 205/500 [01:59&lt;02:52,  1.71it/s]</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[24], line 34</span>
<span class="ansi-green-intense-fg ansi-bold">     32</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> step <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">range</span>(max_steps_per_episode):
<span class="ansi-green-intense-fg ansi-bold">     33</span>     obs, reward, done, truncated, info <span style="color: rgb(98,98,98)">=</span> env_train<span style="color: rgb(98,98,98)">.</span>step(action)
<span class="ansi-green-fg">---&gt; 34</span>     action <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">q_agent</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">step</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">obs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">reward</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">done</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     36</span>     episode_reward <span style="color: rgb(98,98,98)">+</span><span style="color: rgb(98,98,98)">=</span> reward
<span class="ansi-green-intense-fg ansi-bold">     38</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> done <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> truncated:

File <span class="ansi-green-fg">&lt;string&gt;:44</span>, in <span class="ansi-cyan-fg">step</span><span class="ansi-blue-fg">(self, obs, reward, done)</span>

File <span class="ansi-green-fg">&lt;string&gt;:24</span>, in <span class="ansi-cyan-fg">train_model</span><span class="ansi-blue-fg">(self)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/nn/modules/module.py:1739</span>, in <span class="ansi-cyan-fg">Module._wrapped_call_impl</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1737</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_compiled_call_impl(<span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)  <span style="color: rgb(95,135,135)"># type: ignore[misc]</span>
<span class="ansi-green-intense-fg ansi-bold">   1738</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1739</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_call_impl</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/nn/modules/module.py:1750</span>, in <span class="ansi-cyan-fg">Module._call_impl</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1745</span> <span style="color: rgb(95,135,135)"># If we don't have any hooks, we want to skip the rest of the logic in</span>
<span class="ansi-green-intense-fg ansi-bold">   1746</span> <span style="color: rgb(95,135,135)"># this function, and just call forward.</span>
<span class="ansi-green-intense-fg ansi-bold">   1747</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> (<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backward_pre_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_forward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_forward_pre_hooks
<span class="ansi-green-intense-fg ansi-bold">   1748</span>         <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_backward_pre_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_backward_hooks
<span class="ansi-green-intense-fg ansi-bold">   1749</span>         <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_forward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_forward_pre_hooks):
<span class="ansi-green-fg">-&gt; 1750</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">forward_call</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1752</span> result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-intense-fg ansi-bold">   1753</span> called_always_called_hooks <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>()

Cell <span class="ansi-green-fg">In[5], line 15</span>, in <span class="ansi-cyan-fg">DQNetwork.forward</span><span class="ansi-blue-fg">(self, x_tensor)</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span style="color: rgb(0,0,255)">forward</span>(<span style="color: rgb(0,135,0)">self</span>, x_tensor):
<span class="ansi-green-intense-fg ansi-bold">     14</span>     <span style="color: rgb(95,135,135)"># forward should just call your model</span>
<span class="ansi-green-fg">---&gt; 15</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fc</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x_tensor</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/nn/modules/module.py:1739</span>, in <span class="ansi-cyan-fg">Module._wrapped_call_impl</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1737</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_compiled_call_impl(<span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)  <span style="color: rgb(95,135,135)"># type: ignore[misc]</span>
<span class="ansi-green-intense-fg ansi-bold">   1738</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1739</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_call_impl</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/nn/modules/module.py:1750</span>, in <span class="ansi-cyan-fg">Module._call_impl</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1745</span> <span style="color: rgb(95,135,135)"># If we don't have any hooks, we want to skip the rest of the logic in</span>
<span class="ansi-green-intense-fg ansi-bold">   1746</span> <span style="color: rgb(95,135,135)"># this function, and just call forward.</span>
<span class="ansi-green-intense-fg ansi-bold">   1747</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> (<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backward_pre_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_forward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_forward_pre_hooks
<span class="ansi-green-intense-fg ansi-bold">   1748</span>         <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_backward_pre_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_backward_hooks
<span class="ansi-green-intense-fg ansi-bold">   1749</span>         <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_forward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_forward_pre_hooks):
<span class="ansi-green-fg">-&gt; 1750</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">forward_call</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1752</span> result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-intense-fg ansi-bold">   1753</span> called_always_called_hooks <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>()

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/nn/modules/container.py:250</span>, in <span class="ansi-cyan-fg">Sequential.forward</span><span class="ansi-blue-fg">(self, input)</span>
<span class="ansi-green-intense-fg ansi-bold">    248</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span style="color: rgb(0,0,255)">forward</span>(<span style="color: rgb(0,135,0)">self</span>, <span style="color: rgb(0,135,0)">input</span>):
<span class="ansi-green-intense-fg ansi-bold">    249</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> module <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">self</span>:
<span class="ansi-green-fg">--&gt; 250</span>         <span style="color: rgb(0,135,0)">input</span> <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">module</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">input</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    251</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">input</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/nn/modules/module.py:1739</span>, in <span class="ansi-cyan-fg">Module._wrapped_call_impl</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1737</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_compiled_call_impl(<span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs)  <span style="color: rgb(95,135,135)"># type: ignore[misc]</span>
<span class="ansi-green-intense-fg ansi-bold">   1738</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">-&gt; 1739</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_call_impl</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/nn/modules/module.py:1750</span>, in <span class="ansi-cyan-fg">Module._call_impl</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1745</span> <span style="color: rgb(95,135,135)"># If we don't have any hooks, we want to skip the rest of the logic in</span>
<span class="ansi-green-intense-fg ansi-bold">   1746</span> <span style="color: rgb(95,135,135)"># this function, and just call forward.</span>
<span class="ansi-green-intense-fg ansi-bold">   1747</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> (<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backward_pre_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_forward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_forward_pre_hooks
<span class="ansi-green-intense-fg ansi-bold">   1748</span>         <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_backward_pre_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_backward_hooks
<span class="ansi-green-intense-fg ansi-bold">   1749</span>         <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_forward_hooks <span class="ansi-bold" style="color: rgb(175,0,255)">or</span> _global_forward_pre_hooks):
<span class="ansi-green-fg">-&gt; 1750</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">forward_call</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1752</span> result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-intense-fg ansi-bold">   1753</span> called_always_called_hooks <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">set</span>()

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/nn/modules/linear.py:125</span>, in <span class="ansi-cyan-fg">Linear.forward</span><span class="ansi-blue-fg">(self, input)</span>
<span class="ansi-green-intense-fg ansi-bold">    124</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span style="color: rgb(0,0,255)">forward</span>(<span style="color: rgb(0,135,0)">self</span>, <span style="color: rgb(0,135,0)">input</span>: Tensor) <span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">&gt;</span> Tensor:
<span class="ansi-green-fg">--&gt; 125</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">F</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">linear</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">input</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">weight</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">bias</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/opt/conda/lib/python3.12/site-packages/torch/utils/_device.py:104</span>, in <span class="ansi-cyan-fg">DeviceContext.__torch_function__</span><span class="ansi-blue-fg">(self, func, types, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> func <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> _device_constructors() <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> kwargs<span style="color: rgb(98,98,98)">.</span>get(<span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">device</span><span style="color: rgb(175,0,0)">'</span>) <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    103</span>     kwargs[<span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">device</span><span style="color: rgb(175,0,0)">'</span>] <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>device
<span class="ansi-green-fg">--&gt; 104</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">func</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">CellTimeoutError</span>: No reply from kernel before timeout</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=df69d7ad-d39a-454b-baed-3afb680f8f51">
<div class="input">
<div class="prompt input_prompt">In[25]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Test the function with a few steps</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">other_env</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s1">'rgb_array'</span><span class="p">)</span>
<span class="n">obs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">0.49</span><span class="p">))</span>
<span class="n">obs_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">q_agent</span><span class="o">.</span><span class="n">calculate_action</span><span class="p">(</span><span class="n">obs_tensor</span><span class="p">,</span> <span class="n">stochastic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">obs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>  <span class="c1"># Take a random action</span>
    <span class="n">obs_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">display_environment</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,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"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=40e40e83-197e-4c0d-8915-77e241053ce9">
<div class="input">
<div class="prompt input_prompt">In[]:</div><div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</main>
</body>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
